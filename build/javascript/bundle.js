!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=16)}([function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.ENABLE_SIMD=!1,n.SIMD_AVAILABLE=n.ARRAY_TYPE===Float32Array&&"SIMD"in this,n.USE_SIMD=n.ENABLE_SIMD&&n.SIMD_AVAILABLE,n.setMatrixArrayType=function(t){n.ARRAY_TYPE=t};var r=Math.PI/180;n.toRadian=function(t){return t*r},n.equals=function(t,e){return Math.abs(t-e)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))},t.exports=n},function(t,e,n){e.glMatrix=n(1),e.mat2=n(53),e.mat2d=n(54),e.mat3=n(12),e.mat4=n(55),e.quat=n(56),e.vec2=n(57),e.vec3=n(13),e.vec4=n(14)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(7),s=r(a),u=n(4),l=r(u),c=n(34),h=r(c),f={};(0,h.default)(f),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var d=function(){function t(){i(this,t),this.definition=175,this.width=175,this.height=175,this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.active=!1,this.updated=!1,this.defer=s.default.defer(),this.debug=!0,this.threshold=100,this.framerate=60,this.targetFps=1/this.framerate*1e3,this.ellapsed=0,this.prevPixels=new Uint8ClampedArray(this.width*this.height),this.currentPixel=new Uint8ClampedArray(this.width*this.height),this.velocityMap=[],this.colorsMap=[],this.on=f.on.bind(f),this.init()}return o(t,[{key:"toggleDebug",value:function(){this.debug?(this.canvas.style.display="none",this.debug=!1):(this.canvas.style.display="block",this.debug=!0)}},{key:"changeDefinition",value:function(t){console.log(t),this.width=t,this.height=t,this.canvas.width=this.width,this.canvas.height=this.height,this.prevPixels=new Uint8ClampedArray(this.width*this.height),this.currentPixel=new Uint8ClampedArray(this.width*this.height)}},{key:"init",value:function(){var t=this;document.body.appendChild(this.canvas),this.canvas.classList.add("camvelocity"),this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:1280,height:720}}).then(function(e){t.video.src=window.URL.createObjectURL(e),t.video.onloadedmetadata=function(e){t.video.play()},t.video.play(),t.onloaded()}).catch(function(t){alert("No cam detected... ðŸ˜¢")})}},{key:"onloaded",value:function(){this.active=!0}},{key:"getLoadable",value:function(){return this.defer.promise}},{key:"toGreyScale",value:function(){for(var t=this.ctx.getImageData(0,0,this.width,this.height),e=t.data,n=0,r=e.length;n<r;n+=4){var i=.333*e[n]+.333*e[n+1]+.333*e[n+2];i=Math.pow(i,1.2),e[n+0]=i,e[n+1]=i,e[n+2]=i}this.ctx.putImageData(t,0,0)}},{key:"processPixels",value:function(){var t=this.ctx.getImageData(0,0,this.width,this.height),e=t.data;this.updated=!1,this.velocityMap.length=0,this.colorsMap.length=0;for(var n=0,r=e.length;n<r;n+=4){var i=.333*e[n]+.333*e[n+1]+.333*e[n+2],o=[e[n+0],e[n+1],e[n+2]];i=Math.pow(i,1.2),e[n+0]=i,e[n+1]=i,e[n+2]=i,this.currentPixel[n/4]=e[n];var a=Math.abs(this.prevPixels[n/4]-this.currentPixel[n/4]);if(e[n+0]=a,e[n+1]=a,e[n+2]=a,a>this.threshold){var s=n%(4*this.width)-2*this.width,u=Math.floor(n/this.height);s*=200/this.width,u-=2*this.height,u*=200/this.width,this.velocityMap.push(s),this.velocityMap.push(u),this.velocityMap.push(0),this.colorsMap.push(o[0]/255),this.colorsMap.push(o[1]/255),this.colorsMap.push(o[2]/255)}}this.updated=!0,this.ctx.putImageData(t,0,0)}},{key:"getFramePoints",value:function(){return!1===this.updated?[]:new Float32Array(this.velocityMap)}},{key:"getColors",value:function(){return!1===this.updated?[]:new Float32Array(this.colorsMap)}},{key:"update",value:function(){if(this.active){if(this.ellapsed<this.targetFps)return void(this.ellapsed+=l.default.dt);this.ellapsed=0,this.ctx.drawImage(this.video,0,0,this.width,this.height),this.processPixels();var t=this.prevPixels;this.prevPixels=this.currentPixel,this.currentPixel=t,f.emit("update",null)}}}]),t}(),p=new d;e.default=p},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var o=Date.now();performance.timing&&performance.timing.navigationStart&&(o=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-o}}var a=function(){function t(){r(this,t),this.funcs={},this.dt=1/0,this.dictonary=[],this.last=performance.now(),this.initTime=performance.now(),this.init()}return i(t,[{key:"suscribe",value:function(t,e){this.dictonary.push(t),this.funcs[t]=e}},{key:"init",value:function(){this.update=this.update.bind(this),this.update()}},{key:"update",value:function(){requestAnimationFrame(this.update),this.dt=performance.now()-this.last;for(var t=0;t<this.dictonary.length;t++)this.funcs[this.dictonary[t]]();this.last=performance.now()}}]),t}(),s=new a;e.default=s},function(t,e,n){(function(r){var i;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(o){"use strict";void 0!==(i=function(t){var e,i="undefined"!=typeof setTimeout&&setTimeout,o=function(t,e){return setTimeout(t,e)},a=function(t){return clearTimeout(t)},s=function(t){return i(t,0)};if(function(){return void 0!==r&&"[object process]"===Object.prototype.toString.call(r)}())s=function(t){return r.nextTick(t)};else if(e=function(){return"undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver}())s=function(t){function e(){var t=n;n=void 0,t()}var n,r=document.createTextNode("");new t(e).observe(r,{characterData:!0});var i=0;return function(t){n=t,r.data=i^=1}}(e);else if(!i){var u=n(21);o=function(t,e){return u.setTimer(e,t)},a=u.cancelTimer,s=u.runOnLoop||u.runOnContext}return{setTimer:o,clearTimer:a,asap:s}}.call(e,n,e,t))&&(t.exports=i)}(n(0))}).call(e,n(8))},function(t,e,n){"use strict";var r=n(42)();t.exports=function(t){return t!==r&&null!==t}},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(t){function e(t,e,n,r){var i=w.resolve(t);return arguments.length<2?i:i.then(e,n,r)}function r(t){return new w(t)}function i(t){return function(){for(var e=0,n=arguments.length,r=new Array(n);e<n;++e)r[e]=arguments[e];return E(t,this,r)}}function o(t){for(var e=0,n=arguments.length-1,r=new Array(n);e<n;++e)r[e]=arguments[e+1];return E(t,this,r)}function a(){return new s}function s(){function t(t){r._handler.resolve(t)}function e(t){r._handler.reject(t)}function n(t){r._handler.notify(t)}var r=w._defer();this.promise=r,this.resolve=t,this.reject=e,this.notify=n,this.resolver={resolve:t,reject:e,notify:n}}function u(t){return t&&"function"==typeof t.then}function l(){return w.all(arguments)}function c(t){return e(t,w.all)}function h(t){return e(t,w.settle)}function f(t,n){return e(t,function(t){return w.map(t,n)})}function d(t,n){return e(t,function(t){return w.filter(t,n)})}var p=n(20),m=n(22),v=n(23),_=n(24),b=n(25),g=n(26),x=n(27),M=n(28),y=n(29),S=n(9),w=[m,v,_,g,x,b,M,p,y].reduce(function(t,e){return e(t)},n(31)),E=n(11)(w);return e.promise=r,e.resolve=w.resolve,e.reject=w.reject,e.lift=i,e.try=o,e.attempt=o,e.iterate=w.iterate,e.unfold=w.unfold,e.join=l,e.all=c,e.settle=h,e.any=i(w.any),e.some=i(w.some),e.race=i(w.race),e.map=f,e.filter=d,e.reduce=i(w.reduce),e.reduceRight=i(w.reduceRight),e.isPromiseLike=u,e.Promise=w,e.defer=a,e.TimeoutError=S,e}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function a(){m&&d&&(m=!1,d.length?p=d.concat(p):v=-1,p.length&&s())}function s(){if(!m){var t=i(a);m=!0;for(var e=p.length;e;){for(d=p,p=[];++v<e;)d&&d[v].run();v=-1,e=p.length}d=null,m=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,h,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var d,p=[],m=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||m||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function t(e){Error.call(this),this.message=e,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function t(){return{state:"pending"}}function e(t){return{state:"rejected",reason:t}}function n(t){return{state:"fulfilled",value:t}}function r(r){var i=r.state();return 0===i?t():i>0?n(r.value):e(r.value)}return{pending:t,fulfilled:n,rejected:e,inspect:r}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function t(t,n){function r(e,r,o){var a=t._defer(),s=o.length;return i({f:e,thisArg:r,args:o,params:new Array(s),i:s-1,call:n},a._handler),a}function i(e,r){if(e.i<0)return n(e.f,e.thisArg,e.params,r);t._handler(e.args[e.i]).fold(o,e,void 0,r)}function o(t,e,n){t.params[t.i]=e,t.i-=1,i(t,n)}return arguments.length<2&&(n=e),r}function e(t,e,n,r){try{r.resolve(t.apply(e,n))}catch(t){r.reject(t)}}return t.tryCatchResolve=e,t}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r=n(1),i={};i.create=function(){var t=new r.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},i.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromValues=function(t,e,n,i,o,a,s,u,l){var c=new r.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=i,c[4]=o,c[5]=a,c[6]=s,c[7]=u,c[8]=l,c},i.set=function(t,e,n,r,i,o,a,s,u,l){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=c*a-s*l,f=-c*o+s*u,d=l*o-a*u,p=n*h+r*f+i*d;return p?(p=1/p,t[0]=h*p,t[1]=(-c*r+i*l)*p,t[2]=(s*r-i*a)*p,t[3]=f*p,t[4]=(c*n-i*u)*p,t[5]=(-s*n+i*o)*p,t[6]=d*p,t[7]=(-l*n+r*u)*p,t[8]=(a*n-r*o)*p,t):null},i.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=a*c-s*l,t[1]=i*l-r*c,t[2]=r*s-i*a,t[3]=s*u-o*c,t[4]=n*c-i*u,t[5]=i*o-n*s,t[6]=o*l-a*u,t[7]=r*u-n*l,t[8]=n*a-r*o,t},i.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-a*u)+n*(-l*i+a*s)+r*(u*i-o*s)},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1],p=n[2],m=n[3],v=n[4],_=n[5],b=n[6],g=n[7],x=n[8];return t[0]=f*r+d*a+p*l,t[1]=f*i+d*s+p*c,t[2]=f*o+d*u+p*h,t[3]=m*r+v*a+_*l,t[4]=m*i+v*s+_*c,t[5]=m*o+v*u+_*h,t[6]=b*r+g*a+x*l,t[7]=b*i+g*s+x*c,t[8]=b*o+g*u+x*h,t},i.mul=i.multiply,i.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*r+d*a+l,t[7]=f*i+d*s+c,t[8]=f*o+d*u+h,t},i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*a,t[1]=d*i+f*s,t[2]=d*o+f*u,t[3]=d*a-f*r,t[4]=d*s-f*i,t[5]=d*u-f*o,t[6]=l,t[7]=c,t[8]=h,t},i.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},i.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},i.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,h=r*s,f=i*a,d=i*s,p=i*u,m=o*a,v=o*s,_=o*u;return t[0]=1-h-p,t[3]=c-_,t[6]=f+v,t[1]=c+_,t[4]=1-l-p,t[7]=d-m,t[2]=f-v,t[5]=d+m,t[8]=1-l-h,t},i.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],_=e[15],b=n*s-r*a,g=n*u-i*a,x=n*l-o*a,M=r*u-i*s,y=r*l-o*s,S=i*l-o*u,w=c*m-h*p,E=c*v-f*p,A=c*_-d*p,I=h*v-f*m,F=h*_-d*m,D=f*_-d*v,R=b*D-g*F+x*I+M*A-y*E+S*w;return R?(R=1/R,t[0]=(s*D-u*F+l*I)*R,t[1]=(u*A-a*D-l*E)*R,t[2]=(a*F-s*A+l*w)*R,t[3]=(i*F-r*D-o*I)*R,t[4]=(n*D-i*A+o*E)*R,t[5]=(r*A-n*F-o*w)*R,t[6]=(m*S-v*y+_*M)*R,t[7]=(v*x-p*S-_*g)*R,t[8]=(p*y-m*x+_*b)*R,t):null},i.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t},i.sub=i.subtract,i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=e[0],d=e[1],p=e[2],m=e[3],v=e[4],_=e[5],b=t[6],g=e[7],x=e[8];return Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-m)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-v)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-_)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(l-b)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-g)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-x)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},t.exports=i},function(t,e,n){var r=n(1),i={};i.create=function(){var t=new r.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,n){var i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},i.div=i.divide,i.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},i.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},i.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t},i.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t},i.hermite=function(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*l+i[0]*c,t[1]=e[1]*s+n[1]*u+r[1]*l+i[1]*c,t[2]=e[2]*s+n[2]*u+r[2]*l+i[2]*c,t},i.bezier=function(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,l=s*a,c=3*o*s,h=3*u*a,f=u*o;return t[0]=e[0]*l+n[0]*c+r[0]*h+i[0]*f,t[1]=e[1]*l+n[1]*c+r[1]*h+i[1]*f,t[2]=e[2]*l+n[2]*c+r[2]*h+i[2]*f,t},i.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t},i.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},i.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*o-u*i,h=l*i+u*r-a*o,f=l*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=c*l+d*-a+h*-u-f*-s,t[1]=h*l+d*-s+f*-a-c*-u,t[2]=f*l+d*-u+c*-s-h*-a,t},i.rotateX=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.rotateY=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.rotateZ=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),i.angle=function(t,e){var n=i.fromValues(t[0],t[1],t[2]),r=i.fromValues(e[0],e[1],e[2]);i.normalize(n,n),i.normalize(r,r);var o=i.dot(n,r);return o>1?0:Math.acos(o)},i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))},t.exports=i},function(t,e,n){var r=n(1),i={};i.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},i.div=i.divide,i.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},i.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},i.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},i.lerp=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t},i.random=function(t,e){return e=e||1,t[0]=r.RANDOM(),t[1]=r.RANDOM(),t[2]=r.RANDOM(),t[3]=r.RANDOM(),i.normalize(t,t),i.scale(t,t,e),t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t},i.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*o-u*i,h=l*i+u*r-a*o,f=l*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=c*l+d*-a+h*-u-f*-s,t[1]=h*l+d*-s+f*-a-c*-u,t[2]=f*l+d*-u+c*-s-h*-a,t[3]=e[3],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),i.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-l)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},t.exports=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(7),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(){r(this,t),this.textures={},this.currentUnit=0}return i(t,[{key:"init",value:function(t){this.scene=t,this.gl=t.gl}},{key:"load",value:function(t,e){var n=this,r=new Image;return r.onload=function(){var t=n.initTexture(r);n.textures[e].texture=t,n.textures[e].unit=n.currentUnit,n.currentUnit++,n.textures[e].defer.resolve(t)},r.src=t,this.textures[e]={img:r,defer:a.default.defer()},this.textures[e].defer.promise}},{key:"initTexture",value:function(t){var e=this.gl,n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),n}},{key:"getTexture",value:function(t){if(this.textures[t].texture)return this.textures[t].texture}},{key:"getTextureUnit",value:function(t){if(this.textures[t].unit)return this.textures[t].unit}}]),t}(),u=new s;e.default=u},function(t,e,n){n(17),t.exports=n(19)},function(t,e,n){"use strict";var r=n(18);!function(t){t&&t.__esModule}(r)},function(t,e){},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){p?(h.classList.add("hidden"),f.classList.add("hidden"),d.textContent="Play with the params",p=!1):(h.classList.remove("hidden"),f.classList.remove("hidden"),d.textContent="Hide the params",p=!0)}var o=n(4),a=r(o),s=n(3),u=r(s),l=n(50),c=r(l);a.default.suscribe("motion field",u.default.update.bind(u.default)),a.default.suscribe("scene",c.default.render.bind(c.default));var h=document.querySelector(".dg"),f=document.querySelector(".camvelocity"),d=document.querySelector(".button"),p=!0;d.addEventListener("click",function(){i()}),i()},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(t){function e(t,e,n,i){return r.setTimer(function(){t(n,i,e)},e)}var r=n(5),i=n(9);return function(t){function n(t,n,r){e(o,t,n,r)}function o(t,e){e.resolve(t)}function a(t,e,n){var r=void 0===t?new i("timed out after "+n+"ms"):t;e.reject(r)}return t.prototype.delay=function(t){var e=this._beget();return this._handler.fold(n,t,void 0,e._handler),e},t.prototype.timeout=function(t,n){var i=this._beget(),o=i._handler,s=e(a,t,n,i._handler);return this._handler.visit(o,function(t){r.clearTimer(s),this.resolve(t)},function(t){r.clearTimer(s),this.reject(t)},o.notify),i},t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e){},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(t){var e=n(10),r=n(11);return function(t){function n(e){function n(t){c=null,this.resolve(t)}function r(t){this.resolved||(c.push(t),0==--l&&this.reject(c))}for(var i,o,a=t._defer(),s=a._handler,u=e.length>>>0,l=u,c=[],h=0;h<u;++h)if(void 0!==(o=e[h])||h in e){if(i=t._handler(o),i.state()>0){s.become(i),t._visitRemaining(e,h,i);break}i.visit(s,n,r)}else--l;return 0===l&&s.reject(new RangeError("any(): array must not be empty")),a}function i(e,n){function r(t){this.resolved||(c.push(t),0==--d&&(h=null,this.resolve(c)))}function i(t){this.resolved||(h.push(t),0==--o&&(c=null,this.reject(h)))}var o,a,s,u=t._defer(),l=u._handler,c=[],h=[],f=e.length>>>0,d=0;for(s=0;s<f;++s)(void 0!==(a=e[s])||s in e)&&++d;for(n=Math.max(n,0),o=d-n+1,d=Math.min(n,d),n>d?l.reject(new RangeError("some(): array must contain at least "+n+" item(s), but had "+d)):0===d&&l.resolve(c),s=0;s<f;++s)(void 0!==(a=e[s])||s in e)&&t._handler(a).visit(l,r,i,l.notify);return u}function o(e,n){return t._traverse(n,e)}function a(e,n){var r=b.call(e);return t._traverse(n,r).then(function(t){return s(r,t)})}function s(e,n){for(var r=n.length,i=new Array(r),o=0,a=0;o<r;++o)n[o]&&(i[a++]=t._handler(e[o]).value);return i.length=a,i}function u(t){return m(t.map(l))}function l(n){var r;return n instanceof t&&(r=n._handler.join()),r&&0===r.state()||!r?p(n).then(e.fulfilled,e.rejected):(r._unreport(),e.inspect(r))}function c(t,e){return arguments.length>2?v.call(t,f(e),arguments[2]):v.call(t,f(e))}function h(t,e){return arguments.length>2?_.call(t,f(e),arguments[2]):_.call(t,f(e))}function f(t){return function(e,n,r){return d(t,void 0,[e,n,r])}}var d=r(t),p=t.resolve,m=t.all,v=Array.prototype.reduce,_=Array.prototype.reduceRight,b=Array.prototype.slice;return t.any=n,t.some=i,t.settle=u,t.map=o,t.filter=a,t.reduce=c,t.reduceRight=h,t.prototype.spread=function(t){return this.then(m).then(function(e){return t.apply(this,e)})},t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function t(){throw new TypeError("catch predicate must be a function")}function e(t,e){return n(e)?t instanceof e:e(t)}function n(t){return t===Error||null!=t&&t.prototype instanceof Error}function r(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function i(t){return t}return function(n){function o(t,n){return function(r){return e(r,n)?t.call(this,r):l(r)}}function a(t,e,n,i){var o=t.call(e);return r(o)?s(o,n,i):n(i)}function s(t,e,n){return u(t).then(function(){return e(n)})}var u=n.resolve,l=n.reject,c=n.prototype.catch;return n.prototype.done=function(t,e){this._handler.visit(this._handler.receiver,t,e)},n.prototype.catch=n.prototype.otherwise=function(e){return arguments.length<2?c.call(this,e):"function"!=typeof e?this.ensure(t):c.call(this,o(arguments[1],e))},n.prototype.finally=n.prototype.ensure=function(t){return"function"!=typeof t?this:this.then(function(e){return a(t,this,i,e)},function(e){return a(t,this,l,e)})},n.prototype.else=n.prototype.orElse=function(t){return this.then(void 0,function(){return t})},n.prototype.yield=function(t){return this.then(function(){return t})},n.prototype.tap=function(t){return this.then(t).yield(this)},n}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(t){return t.prototype.fold=function(e,n){var r=this._beget();return this._handler.fold(function(n,r,i){t._handler(n).fold(function(t,n,r){r.resolve(e.call(this,n,t))},r,this,i)},n,r._handler.receiver,r._handler),r},t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(t){var e=n(10).inspect;return function(t){return t.prototype.inspect=function(){return e(t._handler(this))},t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(t){function e(t,e,r,i){return n(function(e){return[e,t(e)]},e,r,i)}function n(t,e,i,o){function a(o,a){return r(i(o)).then(function(){return n(t,e,i,a)})}return r(o).then(function(n){return r(e(n)).then(function(e){return e?n:r(t(n)).spread(a)})})}var r=t.resolve;return t.iterate=e,t.unfold=n,t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(t){return t.prototype.progress=function(t){return this.then(void 0,void 0,t)},t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(t){return t.prototype.with=t.prototype.withThis=function(t){var e=this._beget(),n=e._handler;return n.receiver=t,this._handler.chain(n,t),e},t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(t){function e(t){throw t}function r(){}var i=n(5).setTimer,o=n(30);return function(t){function n(t){t.handled||(d.push(t),c("Potentially unhandled rejection ["+t.id+"] "+o.formatError(t.value)))}function a(t){var e=d.indexOf(t);e>=0&&(d.splice(e,1),h("Handled previous rejection ["+t.id+"] "+o.formatObject(t.value)))}function s(t,e){f.push(t,e),null===p&&(p=i(u,0))}function u(){for(p=null;f.length>0;)f.shift()(f.shift())}var l,c=r,h=r;"undefined"!=typeof console&&(l=console,c=void 0!==l.error?function(t){l.error(t)}:function(t){l.log(t)},h=void 0!==l.info?function(t){l.info(t)}:function(t){l.log(t)}),t.onPotentiallyUnhandledRejection=function(t){s(n,t)},t.onPotentiallyUnhandledRejectionHandled=function(t){s(a,t)},t.onFatalRejection=function(t){s(e,t.value)};var f=[],d=[],p=null;return t}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function t(t){var n="object"==typeof t&&null!==t&&(t.stack||t.message)?t.stack||t.message:e(t);return t instanceof Error?n:n+" (WARNING: non-Error used)"}function e(t){var e=String(t);return"[object Object]"===e&&"undefined"!=typeof JSON&&(e=n(t,e)),e}function n(t,e){try{return JSON.stringify(t)}catch(t){return e}}return{formatError:t,formatObject:e,tryStringify:n}}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(t){return n(32)({scheduler:new(n(33))(n(5).asap)})}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){(function(r){var i;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(o){"use strict";void 0!==(i=function(){return function(t){function e(t,e){this._handler=t===x?e:n(t)}function n(t){function e(t){i.resolve(t)}function n(t){i.reject(t)}function r(t){i.notify(t)}var i=new y;try{t(e,n,r)}catch(t){n(t)}return i}function i(t){return k(t)?t:new e(x,new S(_(t)))}function o(t){return new e(x,new S(new A(t)))}function a(){return et}function s(){return new e(x,new y)}function u(t,e){return new e(x,new y(t.receiver,t.join().context))}function l(t){return h(H,null,t)}function c(t,e){return h(N,t,e)}function h(t,n,r){function i(e,i,a){a.resolved||f(r,o,e,t(n,i,e),a)}function o(t,e,n){c[t]=e,0==--l&&n.become(new E(c))}for(var a,s="function"==typeof n?i:o,u=new y,l=r.length>>>0,c=new Array(l),h=0;h<r.length&&!u.resolved;++h)a=r[h],void 0!==a||h in r?f(r,s,h,a,u):--l;return 0===l&&u.become(new E(c)),new e(x,u)}function f(t,e,n,r,i){if(L(r)){var o=b(r),a=o.state();0===a?o.fold(e,n,void 0,i):a>0?e(n,o.value,i):(i.become(o),d(t,n+1,o))}else e(n,r,i)}function d(t,e,n){for(var r=e;r<t.length;++r)p(_(t[r]),n)}function p(t,e){if(t!==e){var n=t.state();0===n?t.visit(t,void 0,t._unreport):n<0&&t._unreport()}}function m(t){return"object"!=typeof t||null===t?o(new TypeError("non-iterable passed to race()")):0===t.length?a():1===t.length?i(t[0]):v(t)}function v(t){var n,r,i,o=new y;for(n=0;n<t.length;++n)if(void 0!==(r=t[n])||n in t){if(i=_(r),0!==i.state()){o.become(i),d(t,n+1,i);break}i.visit(o,o.resolve,o.reject)}return new e(x,o)}function _(t){return k(t)?t._handler.join():L(t)?g(t):new E(t)}function b(t){return k(t)?t._handler.join():g(t)}function g(t){try{var e=t.then;return"function"==typeof e?new w(e,t):new E(t)}catch(t){return new A(t)}}function x(){}function M(){}function y(t,n){e.createContext(this,n),this.consumers=void 0,this.receiver=t,this.handler=void 0,this.resolved=!1}function S(t){this.handler=t}function w(t,e){y.call(this),W.enqueue(new P(t,e,this))}function E(t){e.createContext(this),this.value=t}function A(t){e.createContext(this),this.id=++$,this.value=t,this.handled=!1,this.reported=!1,this._report()}function I(t,e){this.rejection=t,this.context=e}function F(t){this.rejection=t}function D(){return new A(new TypeError("Promise cycle"))}function R(t,e){this.continuation=t,this.handler=e}function T(t,e){this.handler=e,this.value=t}function P(t,e,n){this._then=t,this.thenable=e,this.resolver=n}function O(t,e,n,r,i){try{t.call(e,n,r,i)}catch(t){r(t)}}function C(t,e,n,r){this.f=t,this.z=e,this.c=n,this.to=r,this.resolver=Z,this.receiver=this}function k(t){return t instanceof e}function L(t){return("object"==typeof t||"function"==typeof t)&&null!==t}function U(t,n,r,i){if("function"!=typeof t)return i.become(n);e.enterContext(n),j(t,n.value,r,i),e.exitContext()}function B(t,n,r,i,o){if("function"!=typeof t)return o.become(r);e.enterContext(r),Y(t,n,r.value,i,o),e.exitContext()}function z(t,n,r,i,o){if("function"!=typeof t)return o.notify(n);e.enterContext(r),V(t,n,i,o),e.exitContext()}function N(t,e,n){try{return t(e,n)}catch(t){return o(t)}}function j(t,e,n,r){try{r.become(_(t.call(n,e)))}catch(t){r.become(new A(t))}}function Y(t,e,n,r,i){try{t.call(r,e,n,i)}catch(t){i.become(new A(t))}}function V(t,e,n,r){try{r.notify(t.call(n,e))}catch(t){r.notify(t)}}function q(t,e){e.prototype=J(t.prototype),e.prototype.constructor=e}function H(t,e){return e}function G(){}function X(){if("function"==typeof CustomEvent)try{return new CustomEvent("unhandledRejection")instanceof CustomEvent}catch(t){}return!1}function Q(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{return document.createEvent("CustomEvent").initCustomEvent("eventType",!1,!0,{}),!0}catch(t){}return!1}var W=t.scheduler,K=function(){return void 0!==r&&null!==r&&"function"==typeof r.emit?function(t,e){return"unhandledRejection"===t?r.emit(t,e.value,e):r.emit(t,e)}:"undefined"!=typeof self&&X()?function(t,e){return function(n,r){var i=new e(n,{detail:{reason:r.value,key:r},bubbles:!1,cancelable:!0});return!t.dispatchEvent(i)}}(self,CustomEvent):"undefined"!=typeof self&&Q()?function(t,e){return function(n,r){var i=e.createEvent("CustomEvent");return i.initCustomEvent(n,!1,!0,{reason:r.value,key:r}),!t.dispatchEvent(i)}}(self,document):G}(),J=Object.create||function(t){function e(){}return e.prototype=t,new e};e.resolve=i,e.reject=o,e.never=a,e._defer=s,e._handler=_,e.prototype.then=function(t,e,n){var r=this._handler,i=r.join().state();if("function"!=typeof t&&i>0||"function"!=typeof e&&i<0)return new this.constructor(x,r);var o=this._beget(),a=o._handler;return r.chain(a,r.receiver,t,e,n),o},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype._beget=function(){return u(this._handler,this.constructor)},e.all=l,e.race=m,e._traverse=c,e._visitRemaining=d,x.prototype.when=x.prototype.become=x.prototype.notify=x.prototype.fail=x.prototype._unreport=x.prototype._report=G,x.prototype._state=0,x.prototype.state=function(){return this._state},x.prototype.join=function(){for(var t=this;void 0!==t.handler;)t=t.handler;return t},x.prototype.chain=function(t,e,n,r,i){this.when({resolver:t,receiver:e,fulfilled:n,rejected:r,progress:i})},x.prototype.visit=function(t,e,n,r){this.chain(Z,t,e,n,r)},x.prototype.fold=function(t,e,n,r){this.when(new C(t,e,n,r))},q(x,M),M.prototype.become=function(t){t.fail()};var Z=new M;q(x,y),y.prototype._state=0,y.prototype.resolve=function(t){this.become(_(t))},y.prototype.reject=function(t){this.resolved||this.become(new A(t))},y.prototype.join=function(){if(!this.resolved)return this;for(var t=this;void 0!==t.handler;)if((t=t.handler)===this)return this.handler=D();return t},y.prototype.run=function(){var t=this.consumers,e=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var n=0;n<t.length;++n)e.when(t[n])},y.prototype.become=function(t){this.resolved||(this.resolved=!0,this.handler=t,void 0!==this.consumers&&W.enqueue(this),void 0!==this.context&&t._report(this.context))},y.prototype.when=function(t){this.resolved?W.enqueue(new R(t,this.handler)):void 0===this.consumers?this.consumers=[t]:this.consumers.push(t)},y.prototype.notify=function(t){this.resolved||W.enqueue(new T(t,this))},y.prototype.fail=function(t){var e=void 0===t?this.context:t;this.resolved&&this.handler.join().fail(e)},y.prototype._report=function(t){this.resolved&&this.handler.join()._report(t)},y.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},q(x,S),S.prototype.when=function(t){W.enqueue(new R(t,this))},S.prototype._report=function(t){this.join()._report(t)},S.prototype._unreport=function(){this.join()._unreport()},q(y,w),q(x,E),E.prototype._state=1,E.prototype.fold=function(t,e,n,r){B(t,e,this,n,r)},E.prototype.when=function(t){U(t.fulfilled,this,t.receiver,t.resolver)};var $=0;q(x,A),A.prototype._state=-1,A.prototype.fold=function(t,e,n,r){r.become(this)},A.prototype.when=function(t){"function"==typeof t.rejected&&this._unreport(),U(t.rejected,this,t.receiver,t.resolver)},A.prototype._report=function(t){W.afterQueue(new I(this,t))},A.prototype._unreport=function(){this.handled||(this.handled=!0,W.afterQueue(new F(this)))},A.prototype.fail=function(t){this.reported=!0,K("unhandledRejection",this),e.onFatalRejection(this,void 0===t?this.context:t)},I.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,K("unhandledRejection",this.rejection)||e.onPotentiallyUnhandledRejection(this.rejection,this.context))},F.prototype.run=function(){this.rejection.reported&&(K("rejectionHandled",this.rejection)||e.onPotentiallyUnhandledRejectionHandled(this.rejection))},e.createContext=e.enterContext=e.exitContext=e.onPotentiallyUnhandledRejection=e.onPotentiallyUnhandledRejectionHandled=e.onFatalRejection=G;var tt=new x,et=new e(x,tt);return R.prototype.run=function(){this.handler.join().when(this.continuation)},T.prototype.run=function(){var t=this.handler.consumers;if(void 0!==t)for(var e,n=0;n<t.length;++n)e=t[n],z(e.progress,this.value,this.handler,e.receiver,e.resolver)},P.prototype.run=function(){function t(t){r.resolve(t)}function e(t){r.reject(t)}function n(t){r.notify(t)}var r=this.resolver;O(this._then,this.thenable,t,e,n)},C.prototype.fulfilled=function(t){this.f.call(this.c,this.z,t,this.to)},C.prototype.rejected=function(t){this.to.reject(t)},C.prototype.progress=function(t){this.to.notify(t)},e}}.call(e,n,e,t))&&(t.exports=i)}(n(0))}).call(e,n(8))},function(t,e,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function t(t){this._async=t,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var e=this;this.drain=function(){e._drain()}}return t.prototype.enqueue=function(t){this._queue[this._queueLen++]=t,this.run()},t.prototype.afterQueue=function(t){this._afterQueue[this._afterQueueLen++]=t,this.run()},t.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},t.prototype._drain=function(){for(var t=0;t<this._queueLen;++t)this._queue[t].run(),this._queue[t]=void 0;for(this._queueLen=0,this._running=!1,t=0;t<this._afterQueueLen;++t)this._afterQueue[t].run(),this._afterQueue[t]=void 0;this._afterQueueLen=0},t}.call(e,n,e,t))&&(t.exports=r)}(n(0))},function(t,e,n){"use strict";var r,i,o,a,s,u,l,c=n(35),h=n(49),f=Function.prototype.apply,d=Function.prototype.call,p=Object.create,m=Object.defineProperty,v=Object.defineProperties,_=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};r=function(t,e){var n;return h(e),_.call(this,"__ee__")?n=this.__ee__:(n=b.value=p(null),m(this,"__ee__",b),b.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},i=function(t,e){var n,i;return h(e),i=this,r.call(this,t,n=function(){o.call(i,t,n),f.call(e,this,arguments)}),n.__eeOnceListener__=e,this},o=function(t,e){var n,r,i,o;if(h(e),!_.call(this,"__ee__"))return this;if(n=this.__ee__,!n[t])return this;if("object"==typeof(r=n[t]))for(o=0;i=r[o];++o)i!==e&&i.__eeOnceListener__!==e||(2===r.length?n[t]=r[o?0:1]:r.splice(o,1));else r!==e&&r.__eeOnceListener__!==e||delete n[t];return this},a=function(t){var e,n,r,i,o;if(_.call(this,"__ee__")&&(i=this.__ee__[t]))if("object"==typeof i){for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];for(i=i.slice(),e=0;r=i[e];++e)f.call(r,this,o)}else switch(arguments.length){case 1:d.call(i,this);break;case 2:d.call(i,this,arguments[1]);break;case 3:d.call(i,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];f.call(i,this,o)}},s={on:r,once:i,off:o,emit:a},u={on:c(r),once:c(i),off:c(o),emit:c(a)},l=v({},u),t.exports=e=function(t){return null==t?p(l):v(Object(t),u)},e.methods=s},function(t,e,n){"use strict";var r,i=n(36),o=n(44),a=n(45),s=n(46);r=t.exports=function(t,e){var n,r,a,u,l;return arguments.length<2||"string"!=typeof t?(u=e,e=t,t=null):u=arguments[2],null==t?(n=a=!0,r=!1):(n=s.call(t,"c"),r=s.call(t,"e"),a=s.call(t,"w")),l={value:e,configurable:n,enumerable:r,writable:a},u?i(o(u),l):l},r.gs=function(t,e,n){var r,u,l,c;return"string"!=typeof t?(l=n,n=e,e=t,t=null):l=arguments[3],null==e?e=void 0:a(e)?null==n?n=void 0:a(n)||(l=n,n=void 0):(l=e,e=n=void 0),null==t?(r=!0,u=!1):(r=s.call(t,"c"),u=s.call(t,"e")),c={get:e,set:n,configurable:r,enumerable:u},l?i(o(l),c):c}},function(t,e,n){"use strict";t.exports=n(37)()?Object.assign:n(38)},function(t,e,n){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},function(t,e,n){"use strict";var r=n(39),i=n(43),o=Math.max;t.exports=function(t,e){var n,a,s,u=o(arguments.length,2);for(t=Object(i(t)),s=function(r){try{t[r]=e[r]}catch(t){n||(n=t)}},a=1;a<u;++a)e=arguments[a],r(e).forEach(s);if(void 0!==n)throw n;return t}},function(t,e,n){"use strict";t.exports=n(40)()?Object.keys:n(41)},function(t,e,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},function(t,e,n){"use strict";var r=n(6),i=Object.keys;t.exports=function(t){return i(r(t)?Object(t):t)}},function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";var r=n(6);t.exports=function(t){if(!r(t))throw new TypeError("Cannot use null or undefined");return t}},function(t,e,n){"use strict";var r=n(6),i=Array.prototype.forEach,o=Object.create,a=function(t,e){var n;for(n in t)e[n]=t[n]};t.exports=function(t){var e=o(null);return i.call(arguments,function(t){r(t)&&a(Object(t),e)}),e}},function(t,e,n){"use strict";t.exports=function(t){return"function"==typeof t}},function(t,e,n){"use strict";t.exports=n(47)()?String.prototype.contains:n(48)},function(t,e,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},function(t,e,n){"use strict";var r=String.prototype.indexOf;t.exports=function(t){return r.call(this,t,arguments[1])>-1}},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(51),s=(r(a),n(52)),u=r(s),l=n(58),c=r(l),h=n(15),f=(r(h),n(59)),d=r(f),p=n(3),m=r(p),v=n(60),_=r(v),b=n(64),g=r(b),x=n(68),M=r(x),y=n(2),S=r(y),w=(S.default.mat4,S.default.quat,S.default.vec3),E=function(){function t(){i(this,t),this.dpr=window.devicePixelRatio,this.width=window.innerWidth,this.height=window.innerHeight,this.active=!1,this.time=0,this.ratio=this.width/this.height,this.initGui(),this.canvas=document.createElement("canvas"),this.catchContext(),this.camera=new u.default(this,45),this.orbit=new c.default(this),this.points=new _.default(this),this.ground=new g.default(this),this.bloom=new M.default(this),this.active=!0}return o(t,[{key:"initGui",value:function(){this.gui=new d.default.GUI,this.gui.open();var t=this.gui.addFolder("Motion detect");t.open(),t.add(m.default,"threshold",0,255,1),t.add(m.default,"definition",0,720,1).onFinishChange(function(t){m.default.changeDefinition(t)})}},{key:"catchContext",value:function(){document.querySelector("#container").appendChild(this.canvas),this.canvas.width=this.width*this.dpr,this.canvas.height=this.height*this.dpr,this.canvas.style.maxWidth=this.width+"px",this.canvas.style.maxHeight=this.height+"px",this.gl=this.canvas.getContext("webgl2",{antialias:this.dpr<1.5}),this.gl}},{key:"preRender",value:function(){this.gl;this.voxelFBO.prepare(),this.voxel.render(),this.voxelFBO.clean()}},{key:"postRender",value:function(){this.bloom.prepare(),this.points.postRender(),this.bloom.render()}},{key:"render",value:function(){if(this.active){this.time+=.01;var t=this.gl;this.camera.updatePositionMatrix(),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.colorMask(!0,!0,!0,!0),t.viewport(0,0,this.width*this.dpr,this.height*this.dpr),this.orbit.update(),this.camera.updateProjection(this.ratio),this.camera.lookAt(w.fromValues(0,0,0)),this.ground.render(),this.points.render(),this.postRender()}}}]),t}(),A=new E;e.default=A},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={testTexture:"assets/UV_Grid.jpg",heightMap:"assets/heightMap.png"}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),a=function(t){return t&&t.__esModule?t:{default:t}}(o),s=a.default.vec3,u=a.default.mat4,l=a.default.quat,c=function(){function t(e,n){r(this,t),this.scene=e,this.gl=e.gl,this.fov=n,this.position=s.fromValues(0,-2.8,0),this.rotation=s.fromValues(0,0,0),this.quaternion=l.create(),this.pMatrix=u.create(),this.vMatrix=u.create()}return i(t,[{key:"updatePositionMatrix",value:function(){this.gl;u.identity(this.vMatrix),this.quaternion=l.create(),l.rotateX(this.quaternion,this.quaternion,this.rotation[0]),l.rotateY(this.quaternion,this.quaternion,this.rotation[1]),l.rotateZ(this.quaternion,this.quaternion,this.rotation[2]),u.fromRotationTranslationScale(this.vMatrix,this.quaternion,this.position,[1,1,1])}},{key:"lookAt",value:function(t){u.lookAt(this.vMatrix,this.position,t,[0,1,0])}},{key:"getProjectionMatrix",value:function(){return this.pMatrix}},{key:"getViewMatrix",value:function(){return this.vMatrix}},{key:"updateProjection",value:function(t){u.perspective(this.pMatrix,this.fov*Math.PI/180,t,.1,1e3)}},{key:"update",value:function(t){this.updatePositionMatrix(),this.updateProjection(t)}}]),t}();e.default=c},function(t,e,n){var r=n(1),i={};i.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},i.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},i.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},i.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null},i.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},i.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*l+o*c,t[3]=i*l+a*c,t},i.mul=i.multiply,i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t},i.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},i.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},i.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},i.sub=i.subtract,i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],l=e[2],c=e[3];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-l)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},t.exports=i},function(t,e,n){var r=n(1),i={};i.create=function(){var t=new r.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},i.fromValues=function(t,e,n,i,o,a){var s=new r.ARRAY_TYPE(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s[4]=o,s[5]=a,s},i.set=function(t,e,n,r,i,o,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t},i.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*s-o*a)*u,t[5]=(r*a-n*s)*u,t):null},i.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},i.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1],h=n[2],f=n[3],d=n[4],p=n[5];return t[0]=r*l+o*c,t[1]=i*l+a*c,t[2]=r*h+o*f,t[3]=i*h+a*f,t[4]=r*d+o*p+s,t[5]=i*d+a*p+u,t},i.mul=i.multiply,i.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*l,t[1]=i*c+a*l,t[2]=r*-l+o*c,t[3]=i*-l+a*c,t[4]=s,t[5]=u,t},i.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=r*l,t[1]=i*l,t[2]=o*c,t[3]=a*c,t[4]=s,t[5]=u,t},i.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*l+o*c+s,t[5]=i*l+a*c+u,t},i.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},i.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t},i.sub=i.subtract,i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=e[0],c=e[1],h=e[2],f=e[3],d=e[4],p=e[5];return Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-c)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-h)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-f)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-d)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(u-p)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))},t.exports=i},function(t,e,n){var r=n(1),i={scalar:{},SIMD:{}};i.create=function(){var t=new r.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.fromValues=function(t,e,n,i,o,a,s,u,l,c,h,f,d,p,m,v){var _=new r.ARRAY_TYPE(16);return _[0]=t,_[1]=e,_[2]=n,_[3]=i,_[4]=o,_[5]=a,_[6]=s,_[7]=u,_[8]=l,_[9]=c,_[10]=h,_[11]=f,_[12]=d,_[13]=p,_[14]=m,_[15]=v,_},i.set=function(t,e,n,r,i,o,a,s,u,l,c,h,f,d,p,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t[9]=c,t[10]=h,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=v,t},i.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.scalar.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},i.SIMD.transpose=function(t,e){var n,r,i,o,a,s,u,l,c,h;return n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12),a=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(i,o,0,1,4,5),u=SIMD.Float32x4.shuffle(a,s,0,2,4,6),l=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,0,u),SIMD.Float32x4.store(t,4,l),a=SIMD.Float32x4.shuffle(n,r,2,3,6,7),s=SIMD.Float32x4.shuffle(i,o,2,3,6,7),c=SIMD.Float32x4.shuffle(a,s,0,2,4,6),h=SIMD.Float32x4.shuffle(a,s,1,3,5,7),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,h),t},i.transpose=r.USE_SIMD?i.SIMD.transpose:i.scalar.transpose,i.scalar.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],_=e[15],b=n*s-r*a,g=n*u-i*a,x=n*l-o*a,M=r*u-i*s,y=r*l-o*s,S=i*l-o*u,w=c*m-h*p,E=c*v-f*p,A=c*_-d*p,I=h*v-f*m,F=h*_-d*m,D=f*_-d*v,R=b*D-g*F+x*I+M*A-y*E+S*w;return R?(R=1/R,t[0]=(s*D-u*F+l*I)*R,t[1]=(i*F-r*D-o*I)*R,t[2]=(m*S-v*y+_*M)*R,t[3]=(f*y-h*S-d*M)*R,t[4]=(u*A-a*D-l*E)*R,t[5]=(n*D-i*A+o*E)*R,t[6]=(v*x-p*S-_*g)*R,t[7]=(c*S-f*x+d*g)*R,t[8]=(a*F-s*A+l*w)*R,t[9]=(r*A-n*F-o*w)*R,t[10]=(p*y-m*x+_*b)*R,t[11]=(h*x-c*y-d*b)*R,t[12]=(s*E-a*I-u*w)*R,t[13]=(n*I-r*E+i*w)*R,t[14]=(m*g-p*M-v*b)*R,t[15]=(c*M-h*g+f*b)*R,t):null},i.SIMD.invert=function(t,e){var n,r,i,o,a,s,u,l,c,h,f=SIMD.Float32x4.load(e,0),d=SIMD.Float32x4.load(e,4),p=SIMD.Float32x4.load(e,8),m=SIMD.Float32x4.load(e,12);return a=SIMD.Float32x4.shuffle(f,d,0,1,4,5),r=SIMD.Float32x4.shuffle(p,m,0,1,4,5),n=SIMD.Float32x4.shuffle(a,r,0,2,4,6),r=SIMD.Float32x4.shuffle(r,a,1,3,5,7),a=SIMD.Float32x4.shuffle(f,d,2,3,6,7),o=SIMD.Float32x4.shuffle(p,m,2,3,6,7),i=SIMD.Float32x4.shuffle(a,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,a,1,3,5,7),a=SIMD.Float32x4.mul(i,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.mul(r,a),u=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,a),s),u=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),a=SIMD.Float32x4.mul(r,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),s),c=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(o,a)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),a=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(r,2,3,0,1),o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),s),l=SIMD.Float32x4.mul(n,a),a=SIMD.Float32x4.swizzle(a,2,3,0,1),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(i,a)),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,a),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),a=SIMD.Float32x4.mul(n,r),a=SIMD.Float32x4.swizzle(a,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),l),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,a),c),a=SIMD.Float32x4.swizzle(a,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,a),l),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,a)),a=SIMD.Float32x4.mul(n,o),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(i,a)),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),l),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,a),u),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.mul(n,i),a=SIMD.Float32x4.swizzle(a,1,0,3,2),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,a),u),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(r,a)),a=SIMD.Float32x4.swizzle(a,2,3,0,1),u=SIMD.Float32x4.sub(u,SIMD.Float32x4.mul(o,a)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(r,a),c),h=SIMD.Float32x4.mul(n,s),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,2,3,0,1),h),h=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(h,1,0,3,2),h),a=SIMD.Float32x4.reciprocalApproximation(h),h=SIMD.Float32x4.sub(SIMD.Float32x4.add(a,a),SIMD.Float32x4.mul(h,SIMD.Float32x4.mul(a,a))),(h=SIMD.Float32x4.swizzle(h,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(h,s)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(h,u)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(h,l)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(h,c)),t):null},i.invert=r.USE_SIMD?i.SIMD.invert:i.scalar.invert,i.scalar.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],v=e[14],_=e[15];return t[0]=s*(f*_-d*v)-h*(u*_-l*v)+m*(u*d-l*f),t[1]=-(r*(f*_-d*v)-h*(i*_-o*v)+m*(i*d-o*f)),t[2]=r*(u*_-l*v)-s*(i*_-o*v)+m*(i*l-o*u),t[3]=-(r*(u*d-l*f)-s*(i*d-o*f)+h*(i*l-o*u)),t[4]=-(a*(f*_-d*v)-c*(u*_-l*v)+p*(u*d-l*f)),t[5]=n*(f*_-d*v)-c*(i*_-o*v)+p*(i*d-o*f),t[6]=-(n*(u*_-l*v)-a*(i*_-o*v)+p*(i*l-o*u)),t[7]=n*(u*d-l*f)-a*(i*d-o*f)+c*(i*l-o*u),t[8]=a*(h*_-d*m)-c*(s*_-l*m)+p*(s*d-l*h),t[9]=-(n*(h*_-d*m)-c*(r*_-o*m)+p*(r*d-o*h)),t[10]=n*(s*_-l*m)-a*(r*_-o*m)+p*(r*l-o*s),t[11]=-(n*(s*d-l*h)-a*(r*d-o*h)+c*(r*l-o*s)),t[12]=-(a*(h*v-f*m)-c*(s*v-u*m)+p*(s*f-u*h)),t[13]=n*(h*v-f*m)-c*(r*v-i*m)+p*(r*f-i*h),t[14]=-(n*(s*v-u*m)-a*(r*v-i*m)+p*(r*u-i*s)),t[15]=n*(s*f-u*h)-a*(r*f-i*h)+c*(r*u-i*s),t},i.SIMD.adjoint=function(t,e){var n,r,i,o,a,s,u,l,c,h,f,d,p,n=SIMD.Float32x4.load(e,0),r=SIMD.Float32x4.load(e,4),i=SIMD.Float32x4.load(e,8),o=SIMD.Float32x4.load(e,12);return c=SIMD.Float32x4.shuffle(n,r,0,1,4,5),s=SIMD.Float32x4.shuffle(i,o,0,1,4,5),a=SIMD.Float32x4.shuffle(c,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,c,1,3,5,7),c=SIMD.Float32x4.shuffle(n,r,2,3,6,7),l=SIMD.Float32x4.shuffle(i,o,2,3,6,7),u=SIMD.Float32x4.shuffle(c,l,0,2,4,6),l=SIMD.Float32x4.shuffle(l,c,1,3,5,7),c=SIMD.Float32x4.mul(u,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.mul(s,c),f=SIMD.Float32x4.mul(a,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,c),h),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),f),f=SIMD.Float32x4.swizzle(f,2,3,0,1),c=SIMD.Float32x4.mul(s,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),h),p=SIMD.Float32x4.mul(a,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),p),p=SIMD.Float32x4.swizzle(p,2,3,0,1),c=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,3,0,1),l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),u=SIMD.Float32x4.swizzle(u,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),h),d=SIMD.Float32x4.mul(a,c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,c),d),d=SIMD.Float32x4.swizzle(d,2,3,0,1),c=SIMD.Float32x4.mul(a,s),c=SIMD.Float32x4.swizzle(c,1,0,3,2),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,c),p),c=SIMD.Float32x4.swizzle(c,2,3,0,1),d=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,c),d),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(u,c)),c=SIMD.Float32x4.mul(a,l),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(u,c)),d=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),d),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(u,c),f),d=SIMD.Float32x4.sub(d,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.mul(a,u),c=SIMD.Float32x4.swizzle(c,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,c),f),p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(s,c)),c=SIMD.Float32x4.swizzle(c,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,c)),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,c),p),SIMD.Float32x4.store(t,0,h),SIMD.Float32x4.store(t,4,f),SIMD.Float32x4.store(t,8,d),SIMD.Float32x4.store(t,12,p),t},i.adjoint=r.USE_SIMD?i.SIMD.adjoint:i.scalar.adjoint,i.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],v=t[15];return(e*a-n*o)*(h*v-f*m)-(e*s-r*o)*(c*v-f*p)+(e*u-i*o)*(c*m-h*p)+(n*s-r*a)*(l*v-f*d)-(n*u-i*a)*(l*m-h*d)+(r*u-i*s)*(l*p-c*d)},i.SIMD.multiply=function(t,e,n){var r=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4.load(n,0),u=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),a))));SIMD.Float32x4.store(t,0,u);var l=SIMD.Float32x4.load(n,4),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),a))));SIMD.Float32x4.store(t,4,c);var h=SIMD.Float32x4.load(n,8),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),a))));SIMD.Float32x4.store(t,8,f);var d=SIMD.Float32x4.load(n,12),p=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,0,0,0,0),r),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,1,1,1,1),i),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,3,3,3,3),a))));return SIMD.Float32x4.store(t,12,p),t},i.scalar.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],v=e[13],_=e[14],b=e[15],g=n[0],x=n[1],M=n[2],y=n[3];return t[0]=g*r+x*s+M*h+y*m,t[1]=g*i+x*u+M*f+y*v,t[2]=g*o+x*l+M*d+y*_,t[3]=g*a+x*c+M*p+y*b,g=n[4],x=n[5],M=n[6],y=n[7],t[4]=g*r+x*s+M*h+y*m,t[5]=g*i+x*u+M*f+y*v,t[6]=g*o+x*l+M*d+y*_,t[7]=g*a+x*c+M*p+y*b,g=n[8],x=n[9],M=n[10],y=n[11],t[8]=g*r+x*s+M*h+y*m,t[9]=g*i+x*u+M*f+y*v,t[10]=g*o+x*l+M*d+y*_,t[11]=g*a+x*c+M*p+y*b,g=n[12],x=n[13],M=n[14],y=n[15],t[12]=g*r+x*s+M*h+y*m,t[13]=g*i+x*u+M*f+y*v,t[14]=g*o+x*l+M*d+y*_,t[15]=g*a+x*c+M*p+y*b,t},i.multiply=r.USE_SIMD?i.SIMD.multiply:i.scalar.multiply,i.mul=i.multiply,i.scalar.translate=function(t,e,n){var r,i,o,a,s,u,l,c,h,f,d,p,m=n[0],v=n[1],_=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*_+e[12],t[13]=e[1]*m+e[5]*v+e[9]*_+e[13],t[14]=e[2]*m+e[6]*v+e[10]*_+e[14],t[15]=e[3]*m+e[7]*v+e[11]*_+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*m+s*v+h*_+e[12],t[13]=i*m+u*v+f*_+e[13],t[14]=o*m+l*v+d*_+e[14],t[15]=a*m+c*v+p*_+e[15]),t},i.SIMD.translate=function(t,e,n){var r=SIMD.Float32x4.load(e,0),i=SIMD.Float32x4.load(e,4),o=SIMD.Float32x4.load(e,8),a=SIMD.Float32x4.load(e,12),s=SIMD.Float32x4(n[0],n[1],n[2],0);e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11]),r=SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(s,0,0,0,0)),i=SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(s,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(s,2,2,2,2));var u=SIMD.Float32x4.add(r,SIMD.Float32x4.add(i,SIMD.Float32x4.add(o,a)));return SIMD.Float32x4.store(t,12,u),t},i.translate=r.USE_SIMD?i.SIMD.translate:i.scalar.translate,i.scalar.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.SIMD.scale=function(t,e,n){var r,i,o,a=SIMD.Float32x4(n[0],n[1],n[2],0);return r=SIMD.Float32x4.load(e,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(r,SIMD.Float32x4.swizzle(a,0,0,0,0))),i=SIMD.Float32x4.load(e,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(i,SIMD.Float32x4.swizzle(a,1,1,1,1))),o=SIMD.Float32x4.load(e,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(a,2,2,2,2))),t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.scale=r.USE_SIMD?i.SIMD.scale:i.scalar.scale,i.rotate=function(t,e,n,i){var o,a,s,u,l,c,h,f,d,p,m,v,_,b,g,x,M,y,S,w,E,A,I,F,D=i[0],R=i[1],T=i[2],P=Math.sqrt(D*D+R*R+T*T);return Math.abs(P)<r.EPSILON?null:(P=1/P,D*=P,R*=P,T*=P,o=Math.sin(n),a=Math.cos(n),s=1-a,u=e[0],l=e[1],c=e[2],h=e[3],f=e[4],d=e[5],p=e[6],m=e[7],v=e[8],_=e[9],b=e[10],g=e[11],x=D*D*s+a,M=R*D*s+T*o,y=T*D*s-R*o,S=D*R*s-T*o,w=R*R*s+a,E=T*R*s+D*o,A=D*T*s+R*o,I=R*T*s-D*o,F=T*T*s+a,t[0]=u*x+f*M+v*y,t[1]=l*x+d*M+_*y,t[2]=c*x+p*M+b*y,t[3]=h*x+m*M+g*y,t[4]=u*S+f*w+v*E,t[5]=l*S+d*w+_*E,t[6]=c*S+p*w+b*E,t[7]=h*S+m*w+g*E,t[8]=u*A+f*I+v*F,t[9]=l*A+d*I+_*F,t[10]=c*A+p*I+b*F,t[11]=h*A+m*I+g*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},i.scalar.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+l*r,t[5]=a*i+c*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=l*i-o*r,t[9]=c*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r,t},i.SIMD.rotateX=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,4),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,r))),t},i.rotateX=r.USE_SIMD?i.SIMD.rotateX:i.scalar.rotateX,i.scalar.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-l*r,t[1]=a*i-c*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=o*r+l*i,t[9]=a*r+c*i,t[10]=s*r+h*i,t[11]=u*r+f*i,t},i.SIMD.rotateY=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,r),SIMD.Float32x4.mul(a,i))),t},i.rotateY=r.USE_SIMD?i.SIMD.rotateY:i.scalar.rotateY,i.scalar.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+l*r,t[1]=a*i+c*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=l*i-o*r,t[5]=c*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r,t},i.SIMD.rotateZ=function(t,e,n){var r=SIMD.Float32x4.splat(Math.sin(n)),i=SIMD.Float32x4.splat(Math.cos(n));e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);var o=SIMD.Float32x4.load(e,0),a=SIMD.Float32x4.load(e,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,i),SIMD.Float32x4.mul(a,r))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(a,i),SIMD.Float32x4.mul(o,r))),t},i.rotateZ=r.USE_SIMD?i.SIMD.rotateZ:i.scalar.rotateZ,i.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},i.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotation=function(t,e,n){var i,o,a,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<r.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,i=Math.sin(e),o=Math.cos(e),a=1-o,t[0]=s*s*a+o,t[1]=u*s*a+l*i,t[2]=l*s*a-u*i,t[3]=0,t[4]=s*u*a-l*i,t[5]=u*u*a+o,t[6]=l*u*a+s*i,t[7]=0,t[8]=s*l*a+u*i,t[9]=u*l*a-s*i,t[10]=l*l*a+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},i.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.fromRotationTranslation=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,l=o+o,c=r*s,h=r*u,f=r*l,d=i*u,p=i*l,m=o*l,v=a*s,_=a*u,b=a*l;return t[0]=1-(d+m),t[1]=h+b,t[2]=f-_,t[3]=0,t[4]=h-b,t[5]=1-(c+m),t[6]=p+v,t[7]=0,t[8]=f+_,t[9]=p-v,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},i.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},i.fromRotationTranslationScale=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,l=o+o,c=a+a,h=i*u,f=i*l,d=i*c,p=o*l,m=o*c,v=a*c,_=s*u,b=s*l,g=s*c,x=r[0],M=r[1],y=r[2];return t[0]=(1-(p+v))*x,t[1]=(f+g)*x,t[2]=(d-b)*x,t[3]=0,t[4]=(f-g)*M,t[5]=(1-(h+v))*M,t[6]=(m+_)*M,t[7]=0,t[8]=(d+b)*y,t[9]=(m-_)*y,t[10]=(1-(h+p))*y,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},i.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,c=a+a,h=s+s,f=o*l,d=o*c,p=o*h,m=a*c,v=a*h,_=s*h,b=u*l,g=u*c,x=u*h,M=r[0],y=r[1],S=r[2],w=i[0],E=i[1],A=i[2];return t[0]=(1-(m+_))*M,t[1]=(d+x)*M,t[2]=(p-g)*M,t[3]=0,t[4]=(d-x)*y,t[5]=(1-(f+_))*y,t[6]=(v+b)*y,t[7]=0,t[8]=(p+g)*S,t[9]=(v-b)*S,t[10]=(1-(f+m))*S,t[11]=0,t[12]=n[0]+w-(t[0]*w+t[4]*E+t[8]*A),t[13]=n[1]+E-(t[1]*w+t[5]*E+t[9]*A),t[14]=n[2]+A-(t[2]*w+t[6]*E+t[10]*A),t[15]=1,t},i.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,h=r*s,f=i*a,d=i*s,p=i*u,m=o*a,v=o*s,_=o*u;return t[0]=1-h-p,t[1]=c+_,t[2]=f-v,t[3]=0,t[4]=c-_,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+v,t[9]=d-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},i.frustum=function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t},i.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t},i.perspectiveFromFieldOfView=function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},i.ortho=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*l,t[15]=1,t},i.lookAt=function(t,e,n,o){var a,s,u,l,c,h,f,d,p,m,v=e[0],_=e[1],b=e[2],g=o[0],x=o[1],M=o[2],y=n[0],S=n[1],w=n[2];return Math.abs(v-y)<r.EPSILON&&Math.abs(_-S)<r.EPSILON&&Math.abs(b-w)<r.EPSILON?i.identity(t):(f=v-y,d=_-S,p=b-w,m=1/Math.sqrt(f*f+d*d+p*p),f*=m,d*=m,p*=m,a=x*p-M*d,s=M*f-g*p,u=g*d-x*f,m=Math.sqrt(a*a+s*s+u*u),m?(m=1/m,a*=m,s*=m,u*=m):(a=0,s=0,u=0),l=d*u-p*s,c=p*a-f*u,h=f*s-d*a,m=Math.sqrt(l*l+c*c+h*h),m?(m=1/m,l*=m,c*=m,h*=m):(l=0,c=0,h=0),t[0]=a,t[1]=l,t[2]=f,t[3]=0,t[4]=s,t[5]=c,t[6]=d,t[7]=0,t[8]=u,t[9]=h,t[10]=p,t[11]=0,t[12]=-(a*v+s*_+u*b),t[13]=-(l*v+c*_+h*b),t[14]=-(f*v+d*_+p*b),t[15]=1,t)},i.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},i.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t},i.sub=i.subtract,i.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},i.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},i.equals=function(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],m=t[12],v=t[13],_=t[14],b=t[15],g=e[0],x=e[1],M=e[2],y=e[3],S=e[4],w=e[5],E=e[6],A=e[7],I=e[8],F=e[9],D=e[10],R=e[11],T=e[12],P=e[13],O=e[14],C=e[15];return Math.abs(n-g)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-x)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-M)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(a-y)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(s-S)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-w)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(l-E)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-A)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(h-I)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(f-F)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(d-D)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(p-R)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(m-T)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(T))&&Math.abs(v-P)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(_-O)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(O))&&Math.abs(b-C)<=r.EPSILON*Math.max(1,Math.abs(b),Math.abs(C))},t.exports=i},function(t,e,n){var r=n(1),i=n(12),o=n(13),a=n(14),s={};s.create=function(){var t=new r.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,a){var u=o.dot(i,a);return u<-.999999?(o.cross(t,e,i),o.length(t)<1e-6&&o.cross(t,n,i),o.normalize(t,t),s.setAxisAngle(r,t,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(t,i,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+u,s.normalize(r,r))}}(),s.setAxes=function(){var t=i.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],s.normalize(e,s.fromMat3(e,t))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},s.setAxisAngle=function(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},s.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},s.add=a.add,s.multiply=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*c+a*s+i*l-o*u,t[1]=i*c+a*u+o*s-r*l,t[2]=o*c+a*l+r*u-i*s,t[3]=a*c-r*s-i*u-o*l,t},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t},s.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t},s.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t},s.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(t,e,n,r){var i,o,a,s,u,l=e[0],c=e[1],h=e[2],f=e[3],d=n[0],p=n[1],m=n[2],v=n[3];return o=l*d+c*p+h*m+f*v,o<0&&(o=-o,d=-d,p=-p,m=-m,v=-v),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*l+u*d,t[1]=s*c+u*p,t[2]=s*h+u*m,t[3]=s*f+u*v,t},s.sqlerp=function(){var t=s.create(),e=s.create();return function(n,r,i,o,a,u){return s.slerp(t,r,a,u),s.slerp(e,i,o,u),s.slerp(n,t,e,2*u*(1-u)),n}}(),s.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t},s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t},s.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},s.exactEquals=a.exactEquals,s.equals=a.equals,t.exports=s},function(t,e,n){var r=n(1),i={};i.create=function(){var t=new r.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,n){return t[0]=e,t[1]=n,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},i.div=i.divide,i.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},i.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},i.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},i.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},i.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},i.lerp=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t},i.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},i.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},i.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},i.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},i.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},i.forEach=function(){var t=i.create();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},i.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},i.equals=function(t,e){var n=t[0],i=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))},t.exports=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this.scene=e,this.camera=e.camera,this.width=e.width,this.height=e.height,this.mouse={x:0,y:0},this.dragRotation={x:0,y:0},this.zoom=50,this.drag=!1,this.initEvents()}return i(t,[{key:"initEvents",value:function(){function t(t,e){this.mouse.x=2*(t.clientX/this.width-.5),this.mouse.y=2*(t.clientY/this.height-.5);var r=this.mouse.x-n.x,i=this.mouse.y-n.y;this.drag&&(this.dragRotation.x+=1.5*r,this.dragRotation.y+=1.5*i,this.dragRotation.y=Math.min(Math.max(this.dragRotation.y,-Math.PI/4),Math.PI/4)),n.x=this.mouse.x,n.y=this.mouse.y}var e=this,n={x:0,y:0};window.addEventListener("mousemove",t.bind(this)),window.addEventListener("mousedown",function(){e.drag=!0}),window.addEventListener("mouseup",function(){e.drag=!1}),window.addEventListener("wheel",function(t){e.zoom+=t.deltaY/10,e.zoom=Math.min(Math.max(e.zoom,10),150)})}},{key:"update",value:function(){this.camera.position[0]=Math.cos(this.dragRotation.x)*this.zoom,this.camera.position[1]=Math.sin(this.dragRotation.y)*this.zoom,this.camera.position[2]=Math.sin(this.dragRotation.x)*this.zoom}}]),t}();e.default=o},function(t,e,n){"use strict";function r(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),a=t.a,s=Math.round(t.h),u=t.s.toFixed(1),l=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=t.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+a+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+u+",v:"+l+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+u+",v:"+l+",a:"+a+"}":"unknown format"}function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(V.recalculateRGB(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(V.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(V.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(V.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t){if("0"===t||R.isUndefined(t))return 0;var e=t.match(X);return R.isNull(e)?0:parseFloat(e[1])}function s(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}function u(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}function l(t,e,n,r,i){return r+(t-e)/(n-e)*(i-r)}function c(t,e,n,r){t.style.background="",R.each(rt,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}function h(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}function f(t){setTimeout(t,1e3/60)}function d(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function p(t){Q.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&Q.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function m(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function v(t,e,n){if(n.__li=e,n.__gui=t,R.extend(n,{options:function(e){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),b(t,n.object,n.property,{before:r,factoryArgs:[R.toArray(arguments)]})}if(R.isArray(e)||R.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),b(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof tt){var r=new $(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});R.each(["updateDisplay","onChange","onFinishChange","step"],function(t){var e=n[t],i=r[t];n[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(r,t),e.apply(n,t)}}),Q.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof $){var i=function(e){if(R.isNumber(n.__min)&&R.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=b(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return e};n.min=R.compose(i,n.min),n.max=R.compose(i,n.max)}else n instanceof W?(Q.bind(e,"click",function(){Q.fakeEvent(n.__checkbox,"click")}),Q.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof et?(Q.bind(e,"click",function(){Q.fakeEvent(n.__button,"click")}),Q.bind(e,"mouseover",function(){Q.addClass(n.__button,"hover")}),Q.bind(e,"mouseout",function(){Q.removeClass(n.__button,"hover")})):n instanceof nt&&(Q.addClass(e,"color"),n.updateDisplay=R.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=R.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&m(t.getRoot(),!0),e},n.setValue)}function _(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(-1!==r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[t.preset])a=o[t.preset];else{if(!o[lt])return;a=o[lt]}if(a[r]&&void 0!==a[r][e.property]){var s=a[r][e.property];e.initialValue=s,e.setValue(s)}}}}function b(t,e,n,r){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var i=void 0;if(r.color)i=new nt(e,n);else{var o=[e,n].concat(r.factoryArgs);i=ot.apply(t,o)}r.before instanceof q&&(r.before=r.before.__li),_(t,i),Q.addClass(i.domElement,"c");var a=document.createElement("span");Q.addClass(a,"property-name"),a.innerHTML=i.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(i.domElement);var u=d(t,s,r.before);return Q.addClass(u,vt.CLASS_CONTROLLER_ROW),i instanceof nt?Q.addClass(u,"color"):Q.addClass(u,U(i.getValue())),v(t,u,i),t.__controllers.push(i),i}function g(t,e){return document.location.href+"."+e}function x(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function M(t,e){e.style.display=t.useLocalStorage?"block":"none"}function y(t){var e=t.__save_row=document.createElement("li");Q.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),Q.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",Q.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",Q.addClass(r,"button"),Q.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",Q.addClass(i,"button"),Q.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",Q.addClass(o,"button"),Q.addClass(o,"revert");var a=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?R.each(t.load.remembered,function(e,n){x(t,n,n===t.preset)}):x(t,lt,!1),Q.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),ct){var s=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(g(t,"isLocal"))&&u.setAttribute("checked","checked"),M(t,s),Q.bind(u,"change",function(){t.useLocalStorage=!t.useLocalStorage,M(t,s)})}var l=document.getElementById("dg-new-constructor");Q.bind(l,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||ht.hide()}),Q.bind(n,"click",function(){l.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),ht.show(),l.focus(),l.select()}),Q.bind(r,"click",function(){t.save()}),Q.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),Q.bind(o,"click",function(){t.revert()})}function S(t){function e(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function n(){Q.removeClass(t.__closeButton,vt.CLASS_DRAG),Q.unbind(window,"mousemove",e),Q.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),i=r.clientX,Q.addClass(t.__closeButton,vt.CLASS_DRAG),Q.bind(window,"mousemove",e),Q.bind(window,"mouseup",n),!1}var i=void 0;t.__resize_handle=document.createElement("div"),R.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Q.bind(t.__resize_handle,"mousedown",r),Q.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function w(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function E(t,e){var n={};return R.each(t.__rememberedObjects,function(r,i){var o={},a=t.__rememberedObjectIndecesToControllers[i];R.each(a,function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[i]=o}),n}function A(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}function I(t){0!==t.length&&at.call(window,function(){I(t)}),R.each(t,function(t){t.updateDisplay()})}Object.defineProperty(e,"__esModule",{value:!0});var F=Array.prototype.forEach,D=Array.prototype.slice,R={BREAK:{},extend:function(t){return this.each(D.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(e[n])||(t[n]=e[n])}.bind(this))},this),t},defaults:function(t){return this.each(D.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach(function(n){this.isUndefined(t[n])&&(t[n]=e[n])}.bind(this))},this),t},compose:function(){var t=D.call(arguments);return function(){for(var e=D.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,n){if(t)if(F&&t.forEach&&t.forEach===F)t.forEach(e,n);else if(t.length===t.length+0){var r=void 0,i=void 0;for(r=0,i=t.length;r<i;r++)if(r in t&&e.call(n,t[r],r)===this.BREAK)return}else for(var o in t)if(e.call(n,t[o],o)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r=void 0;return function(){function i(){r=null,n||t.apply(o,a)}var o=this,a=arguments,s=n||!r;clearTimeout(r),r=setTimeout(i,e),s&&t.apply(o,a)}},toArray:function(t){return t.toArray?t.toArray():D.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}},T=[{litmus:R.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:r},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:r},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:r},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:r}}},{litmus:R.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:R.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:R.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(R.isNumber(t.r)&&R.isNumber(t.g)&&R.isNumber(t.b)&&R.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(R.isNumber(t.r)&&R.isNumber(t.g)&&R.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(R.isNumber(t.h)&&R.isNumber(t.s)&&R.isNumber(t.v)&&R.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(R.isNumber(t.h)&&R.isNumber(t.s)&&R.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],P=void 0,O=void 0,C=function(){O=!1;var t=arguments.length>1?R.toArray(arguments):arguments[0];return R.each(T,function(e){if(e.litmus(t))return R.each(e.conversions,function(e,n){if(P=e.read(t),!1===O&&!1!==P)return O=P,P.conversionName=n,P.conversion=e,R.BREAK}),R.BREAK}),O},k=void 0,L={hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r,a=void 0,s=void 0;return 0===i?{h:NaN,s:0,v:0}:(s=o/i,a=t===i?(e-n)/o:e===i?2+(n-t)/o:4+(t-e)/o,a/=6,a<0&&(a+=1),{h:360*a,s:s,v:i/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,n){return n<<(k=8*e)|t&~(255<<k)}},U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},z=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),N=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},j=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Y=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},V=function(){function t(){if(B(this,t),this.__state=C.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return z(t,[{key:"toString",value:function(){return r(this)}},{key:"toHexString",value:function(){return r(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();V.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=L.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");R.extend(t.__state,L.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},V.recalculateHSV=function(t){var e=L.rgb_to_hsv(t.r,t.g,t.b);R.extend(t.__state,{s:e.s,v:e.v}),R.isNaN(e.h)?R.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},V.COMPONENTS=["r","g","b","h","s","v","hex","a"],i(V.prototype,"r",2),i(V.prototype,"g",1),i(V.prototype,"b",0),o(V.prototype,"h"),o(V.prototype,"s"),o(V.prototype,"v"),Object.defineProperty(V.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(V.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=L.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}});var q=function(){function t(e,n){B(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return z(t,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),H={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},G={};R.each(H,function(t,e){R.each(t,function(t){G[t]=e})});var X=/(\d+(\.\d+)?)px/,Q={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var r=n,i=e;R.isUndefined(i)&&(i=!0),R.isUndefined(r)&&(r=!0),t.style.position="absolute",i&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,r){var i=n||{},o=G[e];if(!o)throw new Error("Event type "+e+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":var s=i.x||i.clientX||0,u=i.y||i.clientY||0;a.initMouseEvent(e,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,s,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var l=a.initKeyboardEvent||a.initKeyEvent;R.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(e,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:a.initEvent(e,i.bubbles||!1,i.cancelable||!0)}R.defaults(a,r),t.dispatchEvent(a)},bind:function(t,e,n,r){var i=r||!1;return t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),Q},unbind:function(t,e,n,r){var i=r||!1;return t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),Q},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Q},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);-1!==r&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return Q},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return a(e["border-left-width"])+a(e["border-right-width"])+a(e["padding-left"])+a(e["padding-right"])+a(e.width)},getHeight:function(t){var e=getComputedStyle(t);return a(e["border-top-width"])+a(e["border-bottom-width"])+a(e["padding-top"])+a(e["padding-bottom"])+a(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}},W=function(t){function e(t,n){function r(){o.setValue(!o.__prev)}B(this,e);var i=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i;return i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox"),Q.bind(i.__checkbox,"change",r,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return j(e,t),z(e,[{key:"setValue",value:function(t){var n=N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(q),K=function(t){function e(t,n,r){B(this,e);var i=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r,a=i;if(i.__select=document.createElement("select"),R.isArray(o)){var s={};R.each(o,function(t){s[t]=t}),o=s}return R.each(o,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),a.__select.appendChild(n)}),i.updateDisplay(),Q.bind(i.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),i.domElement.appendChild(i.__select),i}return j(e,t),z(e,[{key:"setValue",value:function(t){var n=N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return Q.isActive(this.__select)?this:(this.__select.value=this.getValue(),N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(q),J=function(t){function e(t,n){function r(){a.setValue(a.__input.value)}function i(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}B(this,e);var o=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),a=o;return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),Q.bind(o.__input,"keyup",r),Q.bind(o.__input,"change",r),Q.bind(o.__input,"blur",i),Q.bind(o.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return j(e,t),z(e,[{key:"updateDisplay",value:function(){return Q.isActive(this.__input)||(this.__input.value=this.getValue()),N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(q),Z=function(t){function e(t,n,r){B(this,e);var i=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=r||{};return i.__min=o.min,i.__max=o.max,i.__step=o.step,R.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=s(i.__impliedStep),i}return j(e,t),z(e,[{key:"setValue",value:function(t){var n=t;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(t){return this.__min=t,this}},{key:"max",value:function(t){return this.__max=t,this}},{key:"step",value:function(t){return this.__step=t,this.__impliedStep=t,this.__precision=s(t),this}}]),e}(q),$=function(t){function e(t,n,r){function i(){var t=parseFloat(h.__input.value);R.isNaN(t)||h.setValue(t)}function o(){h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function a(){o()}function s(t){var e=f-t.clientY;h.setValue(h.getValue()+e*h.__impliedStep),f=t.clientY}function u(){Q.unbind(window,"mousemove",s),Q.unbind(window,"mouseup",u),o()}function l(t){Q.bind(window,"mousemove",s),Q.bind(window,"mouseup",u),f=t.clientY}B(this,e);var c=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,r));c.__truncationSuspended=!1;var h=c,f=void 0;return c.__input=document.createElement("input"),c.__input.setAttribute("type","text"),Q.bind(c.__input,"change",i),Q.bind(c.__input,"blur",a),Q.bind(c.__input,"mousedown",l),Q.bind(c.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1,o())}),c.updateDisplay(),c.domElement.appendChild(c.__input),c}return j(e,t),z(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():u(this.getValue(),this.__precision),N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Z),tt=function(t){function e(t,n,r,i,o){function a(t){document.activeElement.blur(),Q.bind(window,"mousemove",s),Q.bind(window,"mouseup",u),s(t)}function s(t){t.preventDefault();var e=p.__background.getBoundingClientRect();return p.setValue(l(t.clientX,e.left,e.right,p.__min,p.__max)),!1}function u(){Q.unbind(window,"mousemove",s),Q.unbind(window,"mouseup",u),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}function c(t){1===t.touches.length&&(Q.bind(window,"touchmove",h),Q.bind(window,"touchend",f),h(t))}function h(t){var e=t.touches[0].clientX,n=p.__background.getBoundingClientRect();p.setValue(l(e,n.left,n.right,p.__min,p.__max))}function f(){Q.unbind(window,"touchmove",h),Q.unbind(window,"touchend",f),p.__onFinishChange&&p.__onFinishChange.call(p,p.getValue())}B(this,e);var d=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:r,max:i,step:o})),p=d;return d.__background=document.createElement("div"),d.__foreground=document.createElement("div"),Q.bind(d.__background,"mousedown",a),Q.bind(d.__background,"touchstart",c),Q.addClass(d.__background,"slider"),Q.addClass(d.__foreground,"slider-fg"),d.updateDisplay(),d.__background.appendChild(d.__foreground),d.domElement.appendChild(d.__background),d}return j(e,t),z(e,[{key:"updateDisplay",value:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",N(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Z),et=function(t){function e(t,n,r){B(this,e);var i=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===r?"Fire":r,Q.bind(i.__button,"click",function(t){return t.preventDefault(),o.fire(),!1}),Q.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return j(e,t),z(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(q),nt=function(t){function e(t,n){function r(t){l(t),Q.bind(window,"mousemove",l),Q.bind(window,"touchmove",l),Q.bind(window,"mouseup",o),Q.bind(window,"touchend",o)}function i(t){f(t),Q.bind(window,"mousemove",f),Q.bind(window,"touchmove",f),Q.bind(window,"mouseup",a),Q.bind(window,"touchend",a)}function o(){Q.unbind(window,"mousemove",l),Q.unbind(window,"touchmove",l),Q.unbind(window,"mouseup",o),Q.unbind(window,"touchend",o),u()}function a(){Q.unbind(window,"mousemove",f),Q.unbind(window,"touchmove",f),Q.unbind(window,"mouseup",a),Q.unbind(window,"touchend",a),u()}function s(){var t=C(this.value);!1!==t?(p.__color.__state=t,p.setValue(p.__color.toOriginal())):this.value=p.__color.toString()}function u(){p.__onFinishChange&&p.__onFinishChange.call(p,p.__color.toOriginal())}function l(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=p.__saturation_field.getBoundingClientRect(),n=t.touches&&t.touches[0]||t,r=n.clientX,i=n.clientY,o=(r-e.left)/(e.right-e.left),a=1-(i-e.top)/(e.bottom-e.top);return a>1?a=1:a<0&&(a=0),o>1?o=1:o<0&&(o=0),p.__color.v=a,p.__color.s=o,p.setValue(p.__color.toOriginal()),!1}function f(t){-1===t.type.indexOf("touch")&&t.preventDefault();var e=p.__hue_field.getBoundingClientRect(),n=t.touches&&t.touches[0]||t,r=n.clientY,i=1-(r-e.top)/(e.bottom-e.top);return i>1?i=1:i<0&&(i=0),p.__color.h=360*i,p.setValue(p.__color.toOriginal()),!1}B(this,e);var d=Y(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));d.__color=new V(d.getValue()),d.__temp=new V(0);var p=d;d.domElement=document.createElement("div"),Q.makeSelectable(d.domElement,!1),d.__selector=document.createElement("div"),d.__selector.className="selector",d.__saturation_field=document.createElement("div"),d.__saturation_field.className="saturation-field",d.__field_knob=document.createElement("div"),d.__field_knob.className="field-knob",d.__field_knob_border="2px solid ",d.__hue_knob=document.createElement("div"),d.__hue_knob.className="hue-knob",d.__hue_field=document.createElement("div"),d.__hue_field.className="hue-field",d.__input=document.createElement("input"),d.__input.type="text",d.__input_textShadow="0 1px 1px ",Q.bind(d.__input,"keydown",function(t){13===t.keyCode&&s.call(this)}),Q.bind(d.__input,"blur",s),Q.bind(d.__selector,"mousedown",function(){Q.addClass(this,"drag").bind(window,"mouseup",function(){Q.removeClass(p.__selector,"drag")})}),Q.bind(d.__selector,"touchstart",function(){Q.addClass(this,"drag").bind(window,"touchend",function(){Q.removeClass(p.__selector,"drag")})});var m=document.createElement("div");return R.extend(d.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),R.extend(d.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:d.__field_knob_border+(d.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),R.extend(d.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),R.extend(d.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),R.extend(m.style,{width:"100%",height:"100%",background:"none"}),c(m,"top","rgba(0,0,0,0)","#000"),R.extend(d.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),h(d.__hue_field),R.extend(d.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:d.__input_textShadow+"rgba(0,0,0,0.7)"}),Q.bind(d.__saturation_field,"mousedown",r),Q.bind(d.__saturation_field,"touchstart",r),Q.bind(d.__field_knob,"mousedown",r),Q.bind(d.__field_knob,"touchstart",r),Q.bind(d.__hue_field,"mousedown",i),Q.bind(d.__hue_field,"touchstart",i),d.__saturation_field.appendChild(m),d.__selector.appendChild(d.__field_knob),d.__selector.appendChild(d.__saturation_field),d.__selector.appendChild(d.__hue_field),d.__hue_field.appendChild(d.__hue_knob),d.domElement.appendChild(d.__input),d.domElement.appendChild(d.__selector),d.updateDisplay(),d}return j(e,t),z(e,[{key:"updateDisplay",value:function(){var t=C(this.getValue());if(!1!==t){var e=!1;R.each(V.COMPONENTS,function(n){if(!R.isUndefined(t[n])&&!R.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&R.extend(this.__color.__state,t)}R.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;R.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,c(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),R.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),e}(q),rt=["-moz-","-o-","-webkit-","-ms-",""],it={load:function(t,e){var n=e||document,r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=t,n.getElementsByTagName("head")[0].appendChild(r)},inject:function(t,e){var n=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(t){}}},ot=function(t,e){var n=t[e];return R.isArray(arguments[2])||R.isObject(arguments[2])?new K(t,e,arguments[2]):R.isNumber(n)?R.isNumber(arguments[2])&&R.isNumber(arguments[3])?R.isNumber(arguments[4])?new tt(t,e,arguments[2],arguments[3],arguments[4]):new tt(t,e,arguments[2],arguments[3]):R.isNumber(arguments[4])?new $(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new $(t,e,{min:arguments[2],max:arguments[3]}):R.isString(n)?new J(t,e):R.isFunction(n)?new et(t,e,""):R.isBoolean(n)?new W(t,e):null},at=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||f,st=function(){function t(){B(this,t),this.backgroundElement=document.createElement("div"),R.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Q.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),R.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;Q.bind(this.backgroundElement,"click",function(){e.hide()})}return z(t,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),R.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",Q.unbind(t.domElement,"webkitTransitionEnd",e),Q.unbind(t.domElement,"transitionend",e),Q.unbind(t.domElement,"oTransitionEnd",e)};Q.bind(this.domElement,"webkitTransitionEnd",e),Q.bind(this.domElement,"transitionend",e),Q.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Q.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Q.getHeight(this.domElement)/2+"px"}}]),t}(),ut=function(t){if(t&&"undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");it.inject(ut);var lt="Default",ct=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),ht=void 0,ft=!0,dt=void 0,pt=!1,mt=[],vt=function t(e){var n=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Q.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=R.defaults(r,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),r=R.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),R.isUndefined(r.load)?r.load={preset:lt}:r.preset&&(r.load.preset=r.preset),R.isUndefined(r.parent)&&r.hideable&&mt.push(this),r.resizable=R.isUndefined(r.parent)&&r.resizable,r.autoPlace&&R.isUndefined(r.scrollable)&&(r.scrollable=!0);var i=ct&&"true"===localStorage.getItem(g(this,"isLocal")),o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(t){n.parent?n.getRoot().preset=t:r.load.preset=t,A(this),n.revert()}},width:{get:function(){return r.width},set:function(t){r.width=t,w(n,t)}},name:{get:function(){return r.name},set:function(t){r.name=t,titleRowName&&(titleRowName.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(e){r.closed=e,r.closed?Q.addClass(n.__ul,t.CLASS_CLOSED):Q.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return i},set:function(t){ct&&(i=t,t?Q.bind(window,"unload",o):Q.unbind(window,"unload",o),localStorage.setItem(g(n,"isLocal"),t))}}}),R.isUndefined(r.parent)){if(r.closed=!1,Q.addClass(this.domElement,t.CLASS_MAIN),Q.makeSelectable(this.domElement,!1),ct&&i){n.useLocalStorage=!0;var a=localStorage.getItem(g(this,"gui"));a&&(r.load=JSON.parse(a))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,Q.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),r.closeOnTop?(Q.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Q.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Q.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===r.closed&&(r.closed=!0);var s=document.createTextNode(r.name);Q.addClass(s,"controller-name");var u=d(n,s),l=function(t){return t.preventDefault(),n.closed=!n.closed,!1};Q.addClass(this.__ul,t.CLASS_CLOSED),Q.addClass(u,"title"),Q.bind(u,"click",l),r.closed||(this.closed=!1)}r.autoPlace&&(R.isUndefined(r.parent)&&(ft&&(dt=document.createElement("div"),Q.addClass(dt,"dg"),Q.addClass(dt,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(dt),ft=!1),dt.appendChild(this.domElement),Q.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||w(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},Q.bind(window,"resize",this.__resizeHandler),Q.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Q.bind(this.__ul,"transitionend",this.__resizeHandler),Q.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&S(this),o=function(){ct&&"true"===localStorage.getItem(g(n,"isLocal"))&&localStorage.setItem(g(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=o,r.parent||function(){var t=n.getRoot();t.width+=1,R.defer(function(){t.width-=1})}()};vt.toggleHide=function(){pt=!pt,R.each(mt,function(t){t.domElement.style.display=pt?"none":""})},vt.CLASS_AUTO_PLACE="a",vt.CLASS_AUTO_PLACE_CONTAINER="ac",vt.CLASS_MAIN="main",vt.CLASS_CONTROLLER_ROW="cr",vt.CLASS_TOO_TALL="taller-than-window",vt.CLASS_CLOSED="closed",vt.CLASS_CLOSE_BUTTON="close-button",vt.CLASS_CLOSE_TOP="close-top",vt.CLASS_CLOSE_BOTTOM="close-bottom",vt.CLASS_DRAG="drag",vt.DEFAULT_WIDTH=245,vt.TEXT_CLOSED="Close Controls",vt.TEXT_OPEN="Open Controls",vt._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||vt.toggleHide()},Q.bind(window,"keydown",vt._keydownHandler,!1),R.extend(vt.prototype,{add:function(t,e){return b(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return b(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;R.defer(function(){e.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&dt.removeChild(this.domElement);var t=this;R.each(this.__folders,function(e){t.removeFolder(e)}),Q.unbind(window,"keydown",vt._keydownHandler,!1),p(this)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new vt(e);this.__folders[t]=n;var r=d(this,n.domElement);return Q.addClass(r,"folder"),n},removeFolder:function(t){this.__ul.removeChild(t.domElement.parentElement),delete this.__folders[t.name],this.load&&this.load.folders&&this.load.folders[t.name]&&delete this.load.folders[t.name],p(t);var e=this;R.each(t.__folders,function(e){t.removeFolder(e)}),R.defer(function(){e.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=Q.getOffset(t.__ul).top,n=0;R.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=Q.getHeight(e))}),window.innerHeight-e-20<n?(Q.addClass(t.domElement,vt.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(Q.removeClass(t.domElement,vt.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&R.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:R.debounce(function(){this.onResize()},50),remember:function(){if(R.isUndefined(ht)&&(ht=new st,ht.domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;R.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&y(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=E(this)),t.folders={},R.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=E(this),m(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[lt]=E(this,!0)),this.load.remembered[t]=E(this),this.preset=t,x(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){R.each(this.__controllers,function(e){this.getRoot().load.remembered?_(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),R.each(this.__folders,function(t){t.revert(t)}),t||m(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&I(this.__listening)},updateDisplay:function(){R.each(this.__controllers,function(t){t.updateDisplay()}),R.each(this.__folders,function(t){t.updateDisplay()})}});var _t={color:{Color:V,math:L,interpret:C},controllers:{Controller:q,BooleanController:W,OptionController:K,StringController:J,NumberController:Z,NumberControllerBox:$,NumberControllerSlider:tt,FunctionController:et,ColorController:nt},dom:{dom:Q},gui:{GUI:vt},GUI:vt};e.default=_t},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(61),s=r(a),u=n(2),l=r(u),c=n(3),h=r(c),f=l.default.mat4,d=l.default.quat,p=l.default.vec3,m=f.create(),v=function(){function t(e){var n=this;i(this,t),this.scene=e,this.gl=e.gl,this.layers=[],this.position=p.fromValues(0,0,0),this.scale=p.fromValues(-.0665,.05,.05),this.rotation=p.fromValues(0,-Math.PI/2,Math.PI),this.quaternion=d.create(),this.matrix=f.create(),this.debugPrint=document.querySelector(".debugPrint"),this.params={exposure:1.2,particleSize:1.25,discRadius:.35,discFade:.1,hueShift:2.25,colorPass:[1,0,0]},this.initProgram(),this.create=this.create.bind(this),h.default.on("update",function(){n.create()}),this.gui=this.scene.gui.addFolder("Particles"),this.gui.add(this.params,"exposure",-1,2,.001),this.gui.add(this.params,"particleSize",0,2,.01),this.gui.add(this.params,"discRadius",0,1,.01),this.gui.add(this.params,"discFade",0,1,.01),this.gui.add(this.params,"hueShift",0,2*Math.PI,.01),this.gui.open()}return o(t,[{key:"create",value:function(){var t=new s.default(this);t.length>0&&this.layers.push(t)}},{key:"initProgram",value:function(){var t=n(62),e=n(63),r=this.gl,i=r.createShader(r.VERTEX_SHADER);r.shaderSource(i,t),r.compileShader(i);var o=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(i,r.COMPILE_STATUS))return console.error("error vert",r.getShaderInfoLog(i)),null;if(!r.getShaderParameter(o,r.COMPILE_STATUS))return console.error("error frag",r.getShaderInfoLog(o)),null;var a=r.createProgram();if(r.attachShader(a,i),r.attachShader(a,o),r.transformFeedbackVaryings(a,["vPositiions"],r.SEPARATE_ATTRIBS),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS)){var s=r.getProgramInfoLog(a);console.error("Could not initialise shaders",s)}r.useProgram(a),a.vertexPositionAttribute=r.getAttribLocation(a,"aPos"),r.enableVertexAttribArray(a.vertexPositionAttribute),a.directionAttribute=r.getAttribLocation(a,"aDirs"),r.enableVertexAttribArray(a.directionAttribute),a.colorsAttribute=r.getAttribLocation(a,"aColors"),r.enableVertexAttribArray(a.colorsAttribute),a.pMatrixUniform=r.getUniformLocation(a,"uMVP"),a.uTimeUniform=r.getUniformLocation(a,"uTime"),a.uDprUniform=r.getUniformLocation(a,"uDpr"),a.uExposureUniform=r.getUniformLocation(a,"uExposure"),a.uSizeUniform=r.getUniformLocation(a,"uSize"),a.uDiscradiusUniform=r.getUniformLocation(a,"uDiscradius"),a.uBorderUniform=r.getUniformLocation(a,"uBorder"),a.uHueShiftUniform=r.getUniformLocation(a,"uHueShift"),a.uPostPassUniform=r.getUniformLocation(a,"uPostPass"),this.vertShader=i,this.fragSahder=o,this.program=a}},{key:"setMatrixUniforms",value:function(){f.mul(m,this.scene.camera.getProjectionMatrix(),this.scene.camera.getViewMatrix()),f.mul(m,m,this.matrix),this.gl.uniformMatrix4fv(this.program.pMatrixUniform,!1,m)}},{key:"updatePositionMatrix",value:function(){this.gl;f.identity(this.matrix),this.quaternion=d.create(),d.rotateX(this.quaternion,this.quaternion,this.rotation[0]),d.rotateY(this.quaternion,this.quaternion,this.rotation[1]),d.rotateZ(this.quaternion,this.quaternion,this.rotation[2]),f.fromRotationTranslationScale(this.matrix,this.quaternion,this.position,this.scale)}},{key:"delete",value:function(){for(var t=0;t<this.layers.length;t++)this.layers[t].kill()}},{key:"bind",value:function(){var t=this.gl;t.uniform1f(this.program.uDprUniform,this.scene.dpr),t.uniform1f(this.program.uExposureUniform,this.params.exposure),t.uniform1f(this.program.uSizeUniform,this.params.particleSize),t.uniform1f(this.program.uBorderUniform,this.params.discFade),t.uniform1f(this.program.uDiscradiusUniform,this.params.discRadius),t.uniform1f(this.program.uHueShiftUniform,this.params.hueShift)}},{key:"applyState",value:function(){var t=this.gl;t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.enable(t.BLEND)}},{key:"postRender",value:function(){var t=this.gl;t.useProgram(this.program),this.bind(),t.uniform1f(this.program.uPostPassUniform,1),this.layers.length>0&&(this.layers[this.layers.length-1].bind(this.program),t.drawArrays(t.POINTS,0,this.layers[this.layers.length-1].length))}},{key:"render",value:function(){var t=this.gl;t.useProgram(this.program),this.updatePositionMatrix(),this.setMatrixUniforms(),this.applyState(),this.bind(),t.uniform1f(this.program.uPostPassUniform,0);for(var e=performance.now(),n=0;n<this.layers.length;n++){var r=this.layers[n];r.death<e?r.kill():r.render(this.program)}}}]),t}();e.default=v},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),s=r(a),u=n(4),l=r(u),c=n(2),h=r(c),f=h.default.vec3,d=f.create(),p=function(){function t(e){i(this,t),this.factory=e,this.gl=e.scene.gl,this.death=performance.now()+1e3*(3+2*(Math.random()-.5)),this.data=s.default.getFramePoints(),this.colors=s.default.getColors(),this.length=this.data.length/3,this.time=0,this.length>0&&(this.createDirections(),this.initBuffer())}return o(t,[{key:"createIndices",value:function(){for(var t=this.gl,e=[],n=0;n<this.data.length/3;n++)e.push(n);this.indices=new Uint16Array(e);var r=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indices),t.STATIC_DRAW),this.indicesBuffer=r}},{key:"createDirections",value:function(){for(var t=[],e=0;e<this.data.length/3;e++)d=f.fromValues(0,0,3*Math.random()),f.rotateY(d,d,[0,0,0],(Math.random()-.5)*Math.PI*.3),t.push(d[0]),t.push(d[1]),t.push(d[2]);this.directions=new Float32Array(t)}},{key:"initBuffer",value:function(){var t=this.gl,e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,this.data,t.DYNAMIC_COPY),this.bufferIN=e;var n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,4*this.data.length,t.DYNAMIC_COPY),this.bufferOUT=n;var r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,this.directions,t.STATIC_DRAW),this.bufferDirs=r;var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW),this.bufferColors=i,this.transformFeedback=t.createTransformFeedback()}},{key:"bind",value:function(t){var e=this.gl;this.time+=l.default.dt,e.uniform1f(t.uTimeUniform,!1,this.time/1e3),e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,this.transformFeedback),e.bindBuffer(e.ARRAY_BUFFER,this.bufferIN),e.enableVertexAttribArray(t.vertexPositionAttribute),e.vertexAttribPointer(t.vertexPositionAttribute,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.bufferDirs),e.enableVertexAttribArray(t.directionAttribute),e.vertexAttribPointer(t.directionAttribute,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.bufferColors),e.enableVertexAttribArray(t.colorsAttribute),e.vertexAttribPointer(t.colorsAttribute,3,e.FLOAT,!1,0,0)}},{key:"render",value:function(t){var e=this.gl;this.bind(t),e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,0,this.bufferOUT),e.beginTransformFeedback(e.POINTS),e.drawArrays(e.POINTS,0,this.length),e.endTransformFeedback(),e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,0,null);var n=this.bufferIN;this.bufferIN=this.bufferOUT,this.bufferOUT=n}},{key:"kill",value:function(){var t=this.factory.layers.indexOf(this);this.factory.layers.splice(t,1),this.gl.deleteBuffer(this.bufferIN),this.gl.deleteBuffer(this.bufferOUT),this.gl.deleteBuffer(this.bufferDirs),this.gl.deleteBuffer(this.bufferColors)}}]),t}();e.default=p},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nin vec3 aPos;\nin vec3 aDirs;\nin vec3 aColors;\n\nout vec3 vPositiions;\nout vec3 vColor;\n\nuniform mat4 uMVP;\nuniform float uTime;\nuniform float uDpr;\nuniform float uSize;\nuniform float uPostPass;\n\n\nvoid main(void) {\n\n    vec3 pos = aPos;\n\n    float dir = -1.;\n    if(pos.x > .5) {\n        dir = 1.;\n    } \n    \n    float scale         = smoothstep( 1000., -10., pos.z);\n    float vel           = smoothstep( 1200., -10., pos.z);\n\n    pos.z += 7. * (pow(vel, .5) + .01);\n    pos.y +=  .02 * pos.z; \n    pos.y = min(pos.y, 300.);\n\n    pos += aDirs * 3.;\n\n    vPositiions = pos;\n    vColor      = aColors;\n    if(uPostPass > .5){\n        gl_PointSize = 30.;\n    } else {\n        gl_PointSize = 2.5 * scale * uDpr * uSize;\n    }\n    gl_Position = uMVP * vec4(pos, 1.0);\n\n\n}"},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nin vec3 vPositiions;\nin vec3 vColor;\n\nuniform float uExposure;\nuniform float uDiscradius;\nuniform float uBorder;\nuniform float uHueShift;\nuniform float uPostPass;\n\n// uniform float uTime;\n\nout vec4 FRAG_COLOR;\n\nvec3 hueShift( vec3 color, float hueAdjust ){\n\n    const vec3  kRGBToYPrime = vec3 (0.299, 0.587, 0.114);\n    const vec3  kRGBToI      = vec3 (0.596, -0.275, -0.321);\n    const vec3  kRGBToQ      = vec3 (0.212, -0.523, 0.311);\n\n    const vec3  kYIQToR     = vec3 (1.0, 0.956, 0.621);\n    const vec3  kYIQToG     = vec3 (1.0, -0.272, -0.647);\n    const vec3  kYIQToB     = vec3 (1.0, -1.107, 1.704);\n\n    float   YPrime  = dot (color, kRGBToYPrime);\n    float   I       = dot (color, kRGBToI);\n    float   Q       = dot (color, kRGBToQ);\n    float   hue     = atan (Q, I);\n    float   chroma  = sqrt (I * I + Q * Q);\n\n    hue += hueAdjust;\n\n    Q = chroma * sin (hue);\n    I = chroma * cos (hue);\n\n    vec3    yIQ   = vec3 (YPrime, I, Q);\n\n    return vec3( dot (yIQ, kYIQToR), dot (yIQ, kYIQToG), dot (yIQ, kYIQToB) );\n\n}\n\nvoid main() {\n\n    vec2 uv = gl_PointCoord;\n    uv -= vec2(.5);\n    float dist = sqrt(dot(uv, uv));\n    float t = smoothstep(uDiscradius + uBorder, uDiscradius - uBorder, dist);\n\n    float opacity = smoothstep( 2200., -10., vPositiions.z) * t;\n    float offset = smoothstep( 1000., 0., vPositiions.z) * t;\n    vec3 color = hueShift(vColor * pow(2.0, uExposure) * t, uHueShift + offset);\n\n    // if(uPostPass > .5){\n    //     FRAG_COLOR = vec4( 1. * smoothstep(uDiscradius + uBorder * 5., uDiscradius - uBorder * 5., dist) );\n    // } else {\n    // }\n    \n    FRAG_COLOR = vec4( color * pow(opacity, 1.2), opacity );\n\n}"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=r(a),u=n(65),l=r(u),c=n(15),h=(r(c),s.default.mat4),f=s.default.quat,d=s.default.vec3,p=function(){function t(e){i(this,t),this.scene=e,this.gl=e.gl,this.position=d.fromValues(0,-15,0),this.scale=d.fromValues(100,0,100),this.rotation=d.fromValues(0,0,0),this.quaternion=f.create(),this.matrix=h.create(),this.initProgram(),this.initBuffer(),this.initVao(),this.voxelDim=100}return o(t,[{key:"initProgram",value:function(){var t=n(66),e=n(67),r=this.gl,i=r.createShader(r.VERTEX_SHADER);r.shaderSource(i,t),r.compileShader(i);var o=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(i,r.COMPILE_STATUS))return console.error("error vert",r.getShaderInfoLog(i)),null;if(!r.getShaderParameter(o,r.COMPILE_STATUS))return console.error("error frag",r.getShaderInfoLog(o)),null;var a=r.createProgram();r.attachShader(a,i),r.attachShader(a,o),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)||console.error("Could not initialise shaders",r.getProgramInfoLog(a)),r.useProgram(a),a.vertexPositionAttribute=r.getAttribLocation(a,"aPos"),r.enableVertexAttribArray(a.vertexPositionAttribute),a.vertexUvAttribute=r.getAttribLocation(a,"aUvs"),r.enableVertexAttribArray(a.vertexUvAttribute),a.pMatrixUniform=r.getUniformLocation(a,"uPMatrix"),a.mMatrixUniform=r.getUniformLocation(a,"uMMatrix"),a.vMatrixUniform=r.getUniformLocation(a,"uVMatrix"),this.vertShader=i,this.fragSahder=o,this.program=a}},{key:"setMatrixUniforms",value:function(){this.gl.uniformMatrix4fv(this.program.pMatrixUniform,!1,this.scene.camera.getProjectionMatrix()),this.gl.uniformMatrix4fv(this.program.vMatrixUniform,!1,this.scene.camera.getViewMatrix()),this.gl.uniformMatrix4fv(this.program.mMatrixUniform,!1,this.matrix)}},{key:"updatePositionMatrix",value:function(){this.gl;h.identity(this.matrix),this.quaternion=f.create(),f.rotateX(this.quaternion,this.quaternion,this.rotation[0]),f.rotateY(this.quaternion,this.quaternion,this.rotation[1]),f.rotateZ(this.quaternion,this.quaternion,this.rotation[2]),h.fromRotationTranslationScale(this.matrix,this.quaternion,this.position,this.scale)}},{key:"initVao",value:function(){var t=this.gl;this.vao=t.createVertexArray(),t.bindVertexArray(this.vao),t.enableVertexAttribArray(this.program.vertexPositionAttribute),t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.vertexAttribPointer(this.program.vertexPositionAttribute,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.program.vertexUvAttribute),t.bindBuffer(t.ARRAY_BUFFER,this.uvsBuffer),t.vertexAttribPointer(this.program.vertexUvAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bindVertexArray(null)}},{key:"initBuffer",value:function(){var t=this.gl,e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(l.default.vertices),t.STATIC_DRAW);var n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(l.default.uvs),t.STATIC_DRAW);var r=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(l.default.indices),t.STATIC_DRAW),this.vertexPositionBuffer=e,this.uvsBuffer=n,this.indicesBuffer=r}},{key:"applyState",value:function(){var t=this.gl;t.enable(t.DEPTH_TEST)}},{key:"render",value:function(){var t=this.gl,e=this.scene.time;t.useProgram(this.program),t.bindVertexArray(this.vao),this.updatePositionMatrix(),this.setMatrixUniforms(),this.applyState(),t.uniform1f(this.program.uTimeUniform,e),t.drawElements(t.TRIANGLES,l.default.indices.length,t.UNSIGNED_SHORT,0),t.bindVertexArray(null)}}]),t}();e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=[-1,0,1,-1,0,-1,1,0,-1,1,0,1],i=[0,1,2,0,2,3],o=[0,0,0,1,1,1,1,0];e.default={vertices:r,uvs:o,indices:i}},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nin vec3 aPos;\nin vec2 aUvs;\n\nuniform mat4 uMMatrix;\nuniform mat4 uVMatrix;\nuniform mat4 uPMatrix;\n\nout vec2 vUv;\n\nvoid main(void) {\n\n    vUv = aUvs;\n\n    gl_PointSize = 20.;\n    gl_Position = uPMatrix * uVMatrix * uMMatrix * vec4(aPos, 1.0);\n}"},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nin vec2 vUv;\n\nout vec4 FRAG_COLOR;\n\nconst float division = 50.;\n\nvoid main() {\n\n    vec2 circleUv = vUv -.5;\n    float dist = sqrt(dot(circleUv, circleUv));\n    float t = pow(smoothstep(.4, .1, dist), 1.5);\n\n    vec2 uv = vUv.xy * division;\n    vec2 grid = abs(fract(uv - 0.5) - 0.5) / fwidth(uv);\n    float line = min(grid.x, grid.y);\n    \n    FRAG_COLOR = vec4(1.0 - min(line, 1.0)) * t * .6;\n\n}"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(2),s=r(a),u=n(69),l=r(u),c=n(70),h=r(c),f=(s.default.mat4,s.default.quat,s.default.vec3,function(){function t(e){i(this,t),this.scene=e,this.gl=e.gl,this.fbo=new l.default(this.scene),this.params={active:!1,blurX:10,blurY:0,brigth:.5},this.initProgram(),this.initBuffer(),this.initVao(),this.gui=this.scene.gui.addFolder("Post process"),this.gui.add(this.params,"active"),this.gui.add(this.params,"blurX",0,15,.001),this.gui.add(this.params,"blurY",0,15,.001),this.gui.add(this.params,"brigth",0,1,.001),this.gui.open()}return o(t,[{key:"initProgram",value:function(){var t=n(71),e=n(72),r=this.gl,i=r.createShader(r.VERTEX_SHADER);r.shaderSource(i,t),r.compileShader(i);var o=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(i,r.COMPILE_STATUS))return console.error("error vert",r.getShaderInfoLog(i)),null;if(!r.getShaderParameter(o,r.COMPILE_STATUS))return console.error("error frag",r.getShaderInfoLog(o)),null;var a=r.createProgram();r.attachShader(a,i),r.attachShader(a,o),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)||console.error("Could not initialise shaders",r.getProgramInfoLog(a)),r.useProgram(a),a.vertexPositionAttribute=r.getAttribLocation(a,"aPos"),r.enableVertexAttribArray(a.vertexPositionAttribute),a.vertexUvAttribute=r.getAttribLocation(a,"aUvs"),r.enableVertexAttribArray(a.vertexUvAttribute),a.uTextureUniform=r.getUniformLocation(a,"uTexture"),a.uRezUniform=r.getUniformLocation(a,"uRez"),a.uBlurXUniform=r.getUniformLocation(a,"uBlurX"),a.uBlurYUniform=r.getUniformLocation(a,"uBlurY"),a.uBrigthUniform=r.getUniformLocation(a,"uBrigth"),this.vertShader=i,this.fragSahder=o,this.program=a}},{key:"initVao",value:function(){var t=this.gl;this.vao=t.createVertexArray(),t.bindVertexArray(this.vao),t.enableVertexAttribArray(this.program.vertexPositionAttribute),t.bindBuffer(t.ARRAY_BUFFER,this.vertexPositionBuffer),t.vertexAttribPointer(this.program.vertexPositionAttribute,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.program.vertexUvAttribute),t.bindBuffer(t.ARRAY_BUFFER,this.uvsBuffer),t.vertexAttribPointer(this.program.vertexUvAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bindVertexArray(null)}},{key:"initBuffer",value:function(){var t=this.gl,e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(h.default.vertices),t.STATIC_DRAW);var n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(h.default.uvs),t.STATIC_DRAW);var r=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(h.default.indices),t.STATIC_DRAW),this.vertexPositionBuffer=e,this.uvsBuffer=n,this.indicesBuffer=r}},{key:"applyState",value:function(){var t=this.gl;t.disable(t.DEPTH_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.enable(t.BLEND)}},{key:"prepare",value:function(){this.fbo.prepare()}},{key:"render",value:function(){var t=this.gl;this.fbo.clean(),t.useProgram(this.program),t.bindVertexArray(this.vao),this.applyState(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.fbo.getTexture()),t.uniform2fv(this.program.uRezUniform,[this.scene.width*this.scene.dpr,this.scene.height*this.scene.dpr]),t.uniform1f(this.program.uBlurXUniform,this.params.blurX),t.uniform1f(this.program.uBlurYUniform,this.params.blurY),t.uniform1f(this.program.uBrigthUniform,this.params.brigth),this.params.active&&t.drawElements(t.TRIANGLES,h.default.indices.length,t.UNSIGNED_SHORT,0),t.bindVertexArray(null)}}]),t}());e.default=f},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n){r(this,t),this.scene=e,this.gl=e.gl,this.opts=n||{},this.width=this.opts.width||this.scene.width*this.scene.dpr,this.heigth=this.opts.heigth||this.scene.height*this.scene.dpr,this.createTexture(),this.createFB(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}return i(t,[{key:"createTexture",value:function(){this.targetTexture=this.gl.createTexture();var t=this.gl;t.bindTexture(t.TEXTURE_2D,this.targetTexture);var e=t.RGBA,n=t.RGBA,r=t.UNSIGNED_BYTE;t.texImage2D(t.TEXTURE_2D,0,e,this.width,this.heigth,0,n,r,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)}},{key:"createFB",value:function(){var t=this.gl;this.fb=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.fb);var e=t.COLOR_ATTACHMENT0;t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,this.targetTexture,0);var n=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,n),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.heigth),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n)}},{key:"prepare",value:function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.fb),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.viewport(0,0,this.scene.width*this.scene.dpr,this.scene.height*this.scene.dpr)}},{key:"clean",value:function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,null)}},{key:"bind",value:function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,this.targetTexture)}},{key:"getTexture",value:function(){return this.targetTexture}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=[-1,1,0,-1,-1,0,1,-1,0,1,1,0],i=[0,1,2,0,2,3],o=[0,0,0,1,1,1,1,0];e.default={vertices:r,uvs:o,indices:i}},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nin vec3 aPos;\nin vec2 aUvs;\n\nout vec2 vUv;\n\nvoid main(void) {\n    vUv = aUvs;\n    gl_Position = vec4(aPos, 1.0);\n}"},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nin vec2 vUv;\n\nuniform sampler2D uTexture;\nuniform vec2 uRez;\n\nuniform float uBlurX;\nuniform float uBlurY;\nuniform float uBrigth;\n\nout vec4 FRAG_COLOR;\n\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.411764705882353) * direction;\n  vec2 off2 = vec2(3.2941176470588234) * direction;\n  vec2 off3 = vec2(5.176470588235294) * direction;\n  color += texture(image, uv) * 0.1964825501511404;\n  color += texture(image, uv + (off1 / resolution)) * 0.2969069646728344;\n  color += texture(image, uv - (off1 / resolution)) * 0.2969069646728344;\n  color += texture(image, uv + (off2 / resolution)) * 0.09447039785044732;\n  color += texture(image, uv - (off2 / resolution)) * 0.09447039785044732;\n  color += texture(image, uv + (off3 / resolution)) * 0.010381362401148057;\n  color += texture(image, uv - (off3 / resolution)) * 0.010381362401148057;\n  return color;\n}\n\n\nvoid main() {\n\n    vec2 uv = vec2(vUv.x, -vUv.y);\n\n    vec4 base = texture(uTexture, uv);\n    vec4 blur = blur13(uTexture, uv, uRez, vec2(uBlurX, uBlurY)) * .7;\n    blur += blur13(uTexture, uv, uRez, vec2(uBlurY * 2., uBlurX * 2.)) * .3;\n\n    // vec4 color = texture(uTexture, uv);\n    FRAG_COLOR = blur;\n\n}"}]);